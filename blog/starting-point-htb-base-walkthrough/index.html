<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Base Walkthrough | HTB</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="preload" href="../assets/css/app.css%3Fv=f9d12b7c78.css" as="style" />
    <link rel="preload" href="../assets/js/manifest.js%3Fv=f9d12b7c78" as="script" />
    <link rel="preload" href="../assets/js/vendor/content-api.min.js%3Fv=f9d12b7c78" as="script" />
    <link rel="preload" href="../assets/js/vendor.js%3Fv=f9d12b7c78" as="script" />
    <link rel="preload" href="../assets/js/app.js%3Fv=f9d12b7c78" as="script" />
    <link rel="preconnect" href="https://polyfill.io">
    <link rel="dns-prefetch" href="https://polyfill.io">

      <link rel="preload" href="../assets/css/post.css%3Fv=f9d12b7c78.css" as="style" />
  <link rel="preload" href="../assets/js/post.js%3Fv=f9d12b7c78" as="script" />


    <style>
      /* These font-faces are here to make fonts work if the Ghost instance is installed in a subdirectory */

      /* source-sans-pro-regular */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('SourceSansPro-Regular'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-regular.woff2%3Fv=f9d12b7c78") format('woff2'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-regular.woff%3Fv=f9d12b7c78") format('woff');
      }

      /* source-sans-pro-600 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 600;
        font-display: swap;
        src: local('SourceSansPro-SemiBold'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-600.woff2%3Fv=f9d12b7c78") format('woff2'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-600.woff%3Fv=f9d12b7c78") format('woff');
      }

      /* source-sans-pro-700 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: local('SourceSansPro-Bold'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-700.woff2%3Fv=f9d12b7c78") format('woff2'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-700.woff%3Fv=f9d12b7c78") format('woff');
      }

      /* iconmoon */
      @font-face {
        font-family: 'icomoon';
        font-weight: normal;
        font-style: normal;
        font-display: swap;
        src: url("../assets/fonts/icomoon/icomoon.eot%3F101fc3%3Fv=f9d12b7c78");
        src: url("../assets/fonts/icomoon/icomoon.eot%3F101fc3") format('embedded-opentype'),
        url("../assets/fonts/icomoon/icomoon.ttf%3F101fc3%3Fv=f9d12b7c78") format('truetype'),
        url("../assets/fonts/icomoon/icomoon.woff%3F101fc3%3Fv=f9d12b7c78") format('woff'),
        url("../assets/fonts/icomoon/icomoon.svg%3F101fc3") format('svg');
      }
    </style>

    <link rel="stylesheet" type="text/css" href="../assets/css/app.css%3Fv=f9d12b7c78.css" media="screen" />

      <link rel="stylesheet" type="text/css" href="../assets/css/post.css%3Fv=f9d12b7c78.css" media="screen" />


    

    <meta name="description" content="After the Guard Walkthrough, Here I&#x27;m with Base box and this is the last machine on the path of Starting Point. Let&#x27;s hack and grab the flags." />
    <link rel="icon" href="../favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="amp/index.html" />
    
    <meta property="og:site_name" content="h4rithd.com" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Base Walkthrough | HTB" />
    <meta property="og:description" content="After the Guard Walkthrough, Here I&#x27;m with Base box and this is the last machine on the path of Starting Point. Let&#x27;s hack and grab the flags." />
    <meta property="og:url" content="https://h4rithd.com/blog/starting-point-htb-base-walkthrough/" />
    <meta property="og:image" content="https://h4rithd.com/blog/content/images/2021/06/BaseBG.jpg" />
    <meta property="article:published_time" content="2021-05-30T17:16:00.000Z" />
    <meta property="article:modified_time" content="2021-06-02T06:24:38.000Z" />
    <meta property="article:tag" content="Starting Point Walkthrough" />
    <meta property="article:tag" content="Base Walkthrough" />
    <meta property="article:tag" content="h4rithd" />
    <meta property="article:tag" content="Harith Dilshan" />
    
    <meta property="article:publisher" content="https://www.facebook.com/ShapManasick/" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Base Walkthrough | HTB" />
    <meta name="twitter:description" content="After the Guard Walkthrough, Here I&#x27;m with Base box and this is the last machine on the path of Starting Point. Let&#x27;s hack and grab the flags." />
    <meta name="twitter:url" content="https://h4rithd.com/blog/starting-point-htb-base-walkthrough/" />
    <meta name="twitter:image" content="https://h4rithd.com/blog/content/images/2021/06/BaseBG.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Harith Dilshan" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Starting Point Walkthrough, Base Walkthrough, h4rithd, Harith Dilshan" />
    <meta name="twitter:site" content="@h4rithd" />
    <meta name="twitter:creator" content="@h4rithd" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1035" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "h4rithd.com",
        "url": "https://h4rithd.com/blog/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://h4rithd.com/blog/content/images/2021/06/Logo.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Harith Dilshan",
        "image": {
            "@type": "ImageObject",
            "url": "https://h4rithd.com/blog/content/images/2021/06/ProfilePic.jpg",
            "width": 2000,
            "height": 2000
        },
        "url": "https://h4rithd.com/blog/author/h4rithd/",
        "sameAs": [
            "https://h4rithd.com/",
            "https://twitter.com/h4rithd"
        ]
    },
    "headline": "Base Walkthrough | HTB",
    "url": "https://h4rithd.com/blog/starting-point-htb-base-walkthrough/",
    "datePublished": "2021-05-30T17:16:00.000Z",
    "dateModified": "2021-06-02T06:24:38.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://h4rithd.com/blog/content/images/2021/06/BaseBG.jpg",
        "width": 1920,
        "height": 1035
    },
    "keywords": "Starting Point Walkthrough, Base Walkthrough, h4rithd, Harith Dilshan",
    "description": "After the Guard Walkthrough, Here I&#x27;m with Base box and this is the last machine\non the path of Starting Point. Let&#x27;s hack and grab the flags.\n\n\n--------------------------------------------------------------------------------\n\nAs I mentioned before, the starting point machines are a series of 9 machines\nrated as &quot;very easy&quot; and should be rooted in a sequence. So it means, if you\nneed to go through this box, first of all you must have a complete Guard\nmachine.\n\nEnough talks, 🥱 Let’s Get It Start",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://h4rithd.com/blog/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.6" />
    <link rel="alternate" type="application/rss+xml" title="h4rithd.com" href="../rss/index.html" />
    
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/themes/prism-tomorrow.min.css"></link>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/toolbar/prism-toolbar.min.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/line-numbers/prism-line-numbers.min.css" />
<style>
    pre[class*=language-] {
        margin: 1.75em 0;
        font-size: 1.0rem;
        background: #111;
    }
</style>
<style>
.m-footer-copyright span:nth-child(2), .m-footer-copyright span:nth-child(3) {
    display: none;
}
</style>

<style>
blockquote {
    border-left: 4px solid #3897D3;
    font-weight: unset;
    line-height: unset;
    font-size: 17px;
    padding-left: 1rem;
    margin: 1rem 0;
}

.post-author-image {
    width: 100%;
    height: 100%;
}
</style<style>:root {--ghost-accent-color: #0065a3;}</style>

    <script>
      
    </script>
  </head>
  <body class="post-template tag-starting-point-htb tag-base-walkthrough tag-h4rithd tag-harith-dilshan">
    



  
<header class="m-header with-picture js-header">
  <div class="m-mobile-topbar" data-aos="fade-down">
    <button class="m-icon-button in-mobile-topbar js-open-menu" aria-label="Open menu">
      <span class="icon-menu" aria-hidden="true"></span>
    </button>
      <a href="../index.html" class="m-logo in-mobile-topbar">
        <img src="../content/images/2021/06/Logo.png" alt="h4rithd.com">
      </a>
    <button class="m-icon-button in-mobile-topbar js-open-search" aria-label="Open search">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
  </div>

  <div class="m-menu js-menu">
    <button class="m-icon-button outlined as-close-menu js-close-menu" aria-label="Close menu">
      <span class="icon-close"></span>
    </button>
    <div class="m-menu__main" data-aos="fade-down">
      <div class="l-wrapper">
        <div class="m-nav js-main-nav">
          <nav class="m-nav__left js-main-nav-left" role="navigation" aria-label="Main menu">
            <ul>
                <li class="only-desktop">
                  <a href="../index.html" class="m-logo">
                    <img src="../content/images/2021/06/Logo.png" alt="h4rithd.com">
                  </a>
                </li>
                
    <li class="nav-me">
      <a href="https://h4rithd.com/">Me</a>
    </li>
    <li class="nav-blog">
      <a href="https://h4rithd.com/blog/">Blog</a>
    </li>
    <li class="nav-starting-point">
      <a href="https://h4rithd.com/blog/tag/starting-point-htb/">Starting Point</a>
    </li>

              <li class="submenu-option js-submenu-option">
                <button class="m-icon-button in-menu-main more js-toggle-submenu" aria-label="Open submenu">
                  <span class="icon-more" aria-hidden="true"></span>
                </button>
                <div class="m-submenu js-submenu">
                  <div class="l-wrapper in-submenu">
                    <section class="m-recent-articles">
                      <h3 class="m-submenu-title in-recent-articles">Recent articles</h3>
                          <div class="glide js-recent-slider">
                            <div class="glide__track" data-glide-el="track">
                              <div class="glide__slides">
                                <div class="glide__slide">
                                  <a href="index.html" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="../content/images/size/w300/2021/06/BaseBG.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Base Walkthrough">
                                      Base Walkthrough
                                    </h3>
                                    <span class="m-recent-article__date">3 days ago</span>
                                  </a>
                                </div>
                                <div class="glide__slide">
                                  <a href="../starting-point-htb-markup-walkthrough/index.html" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="../content/images/size/w300/2021/06/MarkupBG.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Markup Walkthrough">
                                      Markup Walkthrough
                                    </h3>
                                    <span class="m-recent-article__date">4 days ago</span>
                                  </a>
                                </div>
                                <div class="glide__slide">
                                  <a href="../starting-point-htb-guard-walkthrough/index.html" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="../content/images/size/w300/2021/06/GurdBG.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Guard Walkthrough">
                                      Guard Walkthrough
                                    </h3>
                                    <span class="m-recent-article__date">4 days ago</span>
                                  </a>
                                </div>
                                <div class="glide__slide">
                                  <a href="../starting-point-htb-included-walkthrough/index.html" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="../content/images/size/w300/2021/06/IncludedBG.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Included Walkthrough">
                                      Included Walkthrough
                                    </h3>
                                    <span class="m-recent-article__date">8 days ago</span>
                                  </a>
                                </div>
                              </div>
                            </div>
                          </div>
                    </section>
                    <section class="m-tags">
                      <h3 class="m-submenu-title">Tags</h3>
                        <ul>
                            <li>
                              <a href="../tag/archetype-walkthrough/index.html">Archetype Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/base-walkthrough/index.html">Base Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/guard-walkthrough/index.html">Guard Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/harith-dilshan/index.html">Harith Dilshan</a>
                            </li>
                            <li>
                              <a href="../tag/included-walkthrough/index.html">Included Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/markup-walkthrough/index.html">Markup Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/oopsie-walkthrough/index.html">Oopsie Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/pathfinder-walkthrough/index.html">Pathfinder Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/shield-walkthrough/index.html">Shield Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/starting-point-htb/index.html">Starting Point Walkthrough</a>
                            </li>
                        </ul>
                    </section>
                  </div>
                </div>
              </li>
            </ul>
          </nav>
          <div class="m-nav__right">
            <button class="m-icon-button in-menu-main js-open-search" aria-label="Open search">
              <span class="icon-search" aria-hidden="true"></span>
            </button>
            <div class="m-toggle-darkmode js-tooltip" data-tippy-content="Toggle dark mode" tabindex="0">
              <label for="toggle-darkmode" class="sr-only">
                Toggle dark mode
              </label>
              <input id="toggle-darkmode" type="checkbox" class="js-toggle-darkmode">
              <div>
                <span class="icon-moon moon" aria-hidden="true"></span>
                <span class="icon-sunny sun" aria-hidden="true"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</header>

<main class="main-wrap">
    
  <section class="m-hero with-picture" data-aos="fade">
    <div class="m-hero__picture in-post">
      <img
        srcset="../content/images/size/w300/2021/06/BaseBG.jpg/BaseBG.jpg 300w../content/images/size/w600/2021/06/BaseBG.jpg6/BaseBG.jpg 600../content/images/size/w1000/2021/06/BaseBG.jpg06/BaseBG.jpg 100../content/images/size/w2000/2021/06/BaseBG.jpg/06/BaseBG.jpg 2000w
        "
        sizes="(max-width: 600px) 600px, (max-width: 1000px) 1000px, 2000px"
        src="../content/images/size/w1000/2021/06/BaseBG.jpg"
        alt=""
      />
    </div>
    </section>
  
  <article>
    <div class="l-content in-post">
        <div class="l-wrapper in-post  js-aos-wrapper" data-aos="fade-up"
          data-aos-delay="300">
          <div
            class="l-post-content js-progress-content">
            <header class="m-heading">
              <h1 class="m-heading__title in-post">Base Walkthrough</h1>
              <div class="m-heading__meta">
                  <a href="../tag/starting-point-htb/index.html" class="m-heading__meta__tag">Starting Point Walkthrough</a>
                  <span class="m-heading__meta__divider" aria-hidden="true">&bull;</span>
                <span class="m-heading__meta__time">May 30, 2021</span>
              </div>
            </header>
            <div class="pos-relative js-post-content">
              <div class="m-share">
                <div class="m-share__content js-sticky">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https://h4rithd.com/blog/starting-point-htb-base-walkthrough/"
                    class="m-icon-button filled in-share" target="_blank" rel="noopener" aria-label="Facebook">
                    <span class="icon-facebook" aria-hidden="true"></span>
                  </a>
                  <a href="https://twitter.com/intent/tweet?text=Base%20Walkthrough&url=https://h4rithd.com/blog/starting-point-htb-base-walkthrough/"
                    class="m-icon-button filled in-share" target="_blank" rel="noopener" aria-label="Twitter">
                    <span class="icon-twitter" aria-hidden="true"></span>
                  </a>
                  <button class="m-icon-button filled in-share progress js-scrolltop" aria-label="Scroll to top">
                    <span class="icon-arrow-top" aria-hidden="true"></span>
                    <svg aria-hidden="true">
                      <circle class="progress-ring__circle js-progress" fill="transparent" r="0" />
                    </svg>
                  </button>
                </div>
              </div>
              <p>After the Guard Walkthrough, Here I'm with Base box and this is the last machine on the path of Starting Point. Let's hack and grab the flags.</p><hr><p>As I mentioned before, the starting point machines are a series of 9 machines rated as "<strong>very easy</strong>" and should be <strong>rooted in a sequence</strong>. So it means, if you need to go through this box, first of all you must have a complete Guard machine.</p><p>Enough talks, 🥱 Let’s Get It Started 🐱‍💻</p><blockquote><strong><em>Disclaimers: </em></strong><em>No flags (user/root) are shown in this writeup (as usual in writeups), so follow the procedure to grab the flags! 🐱‍👤</em></blockquote><!--kg-card-begin: html--><script src="https://apps.elfsight.com/p/platform.js" defer></script>
<div class="elfsight-app-a4de7430-6c0c-44b8-aada-9b9ac759e396"></div><!--kg-card-end: html--><hr><h2 id="00-start-machine-%E2%80%A6"><strong>00. Start Machine …</strong></h2><p>To start the machine, Just click on "<strong>Spawn Machine</strong>".</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-213.png" class="kg-image" alt loading="lazy" width="1000" height="453" srcset="../content/images/size/w600/2021/06/image-213.png 600w, ../content/images/2021/06/image-213.png 1000w" sizes="(min-width: 720px) 720px"></figure><p>Then you can see the <strong>IP </strong>address for that machine.<strong>🤠</strong></p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-214.png" class="kg-image" alt loading="lazy" width="418" height="484"></figure><p>Before going to enumeration steps we can simply ping to the IP address and check whether  the VPN is connected and the machine is alive. Sometimes the machines might "Disable" ping requests when passing through the firewall. But in most cases ping will be a success! 🙂</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-215.png" class="kg-image" alt loading="lazy" width="1480" height="554" srcset="../content/images/size/w600/2021/06/image-215.png 600w, ../content/images/size/w1000/2021/06/image-215.png 1000w, ../content/images/2021/06/image-215.png 1480w" sizes="(min-width: 720px) 720px"></figure><p>As a ping result, it's <code>TTL=63</code>. There is only one route between machine and us (VPN). So definitely it will be a <code>Linux</code> machine.</p><hr><h2 id="01-enumeration-first-%E2%80%A6"><strong><strong>01. Enumeration First …</strong></strong></h2><h3 id="011-fast-ports-scan"><strong><strong>01.1 Fast ports scan</strong></strong></h3><p>As usual, run Nmap fast scan for all TCP ports to identify the ports which are open.</p><pre><code class="language-bash">nmap -n -vv --open -T4 -p- -oN AllPorts.nmap 10.10.10.48</code></pre><pre><code class="language-bash">-n  : Never do DNS resolution
-vv	: Extra verbosity
--open	: Output only open ports
-p-	: Full TCP ports range (65535)
-T4	: Aggressive (4) speeds scans; assumes you are on a reasonably fast and reliable network</code></pre><p>Here is the output 👇</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-216.png" class="kg-image" alt loading="lazy" width="1000" height="620" srcset="../content/images/size/w600/2021/06/image-216.png 600w, ../content/images/2021/06/image-216.png 1000w" sizes="(min-width: 720px) 720px"></figure><p>There are only two open ports... 🤨🤨</p><h3 id="012-run-nmap-scripting-engine"><strong><strong>01.2 Run Nmap Scripting Engine</strong></strong></h3><p>To get the best result, we can run the <code>Nmap Scripting Engine</code> for all open ports. Now we know all of the open ports and therefore we can point out and run the script engine as fast as possible.</p><pre><code class="language-bash">nmap -sV -sC -oN DetailPorts.nmap -p 22,80 10.10.10.48</code></pre><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-217.png" class="kg-image" alt loading="lazy" width="1000" height="548" srcset="../content/images/size/w600/2021/06/image-217.png 600w, ../content/images/2021/06/image-217.png 1000w" sizes="(min-width: 720px) 720px"></figure><p>Since we have only two ports I will catch port 80 as my first enumeration path.</p><p>Let's check what we got on port 80 by navigating to the <code>http://10.10.10.48/</code> form any browser you have.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-218.png" class="kg-image" alt loading="lazy" width="1322" height="776" srcset="../content/images/size/w600/2021/06/image-218.png 600w, ../content/images/size/w1000/2021/06/image-218.png 1000w, ../content/images/2021/06/image-218.png 1322w" sizes="(min-width: 720px) 720px"></figure><p>Here we have <code>login</code> button. By clicking on that button you will navigate to the <code>http://10.10.10.48/login/login.php</code> page.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-219.png" class="kg-image" alt loading="lazy" width="1000" height="587" srcset="../content/images/size/w600/2021/06/image-219.png 600w, ../content/images/2021/06/image-219.png 1000w" sizes="(min-width: 720px) 720px"></figure><p>After doing some enumerations on the web page I was accidently navigated to the <code>http://10.10.10.48/login/</code> page. Take a look at what I got here!!</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-220.png" class="kg-image" alt loading="lazy" width="1034" height="455" srcset="../content/images/size/w600/2021/06/image-220.png 600w, ../content/images/size/w1000/2021/06/image-220.png 1000w, ../content/images/2021/06/image-220.png 1034w" sizes="(min-width: 720px) 720px"></figure><p>There is a file called <code>login.php.swp</code> and we can download that file. When we try to view the file using cat command or any text editor, you will get so many garbage characters. To prevent from happening that I use <code>strings</code> command to view only readable strings in that file. Now we can read the file but the content is reversed. Oh!! If we want to understand that file content, we need to reverse it again. 🤦‍♂️🤦‍♂️</p><pre><code class="language-bash">strings login.php.swp | tac</code></pre><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-221.png" class="kg-image" alt loading="lazy" width="1000" height="470" srcset="../content/images/size/w600/2021/06/image-221.png 600w, ../content/images/2021/06/image-221.png 1000w" sizes="(min-width: 720px) 720px"></figure><p>After reading the PHP source code; it checks the credentials that the user inputs, against the variables that are already stored in <code>config.php</code> to see if they match. Hold on!! Here <code>strcmp</code> is used in the source code and it's insecure here. The following links will help you to get a better understanding about the vulnerability. We can simply say there is a juggling vulnerability here. 👴👴</p><ul><li><a href="https://www.geeksforgeeks.org/string-comparison-using-vs-strcmp-in-php/">String comparison using == vs strcmp() in PHP</a></li><li><a href="https://hydrasky.com/network-security/php-string-comparison-vulnerabilities/">PHP String Comparison Vulnerabilities</a></li><li><a href="https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf">PHP Magic Tricks: Type Juggling</a></li></ul><hr><h2 id="02-foothold"><strong><strong>02. Foothold</strong></strong></h2><p>Let me tell you simply what is happening. Here strcmp is given an empty array to compare against the stored password, so it will return <strong>null</strong> and in PHP, <strong>==</strong> operator only checks the value of a variable for <strong>equality.</strong> Hence the value of <strong>NULL is equal to 0 </strong>here. It's clear now, isn't it? To mitigate that kind of vulnerability; should use <strong>===</strong> instead of <strong>==</strong>. 🤕🤕</p><p>Let's power up Burp Suite and try to catch the login request. We got the post request. To take the advantage of this vulnerability, change the request body as follows.👇👇 Then turn off intercept.</p><pre><code class="language-bash">username[]=admin&amp;password[]=h4rithd</code></pre><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-222.png" class="kg-image" alt loading="lazy" width="1000" height="450" srcset="../content/images/size/w600/2021/06/image-222.png 600w, ../content/images/2021/06/image-222.png 1000w" sizes="(min-width: 720px) 720px"></figure><p>Now you will be redirected to the <code>upload.php</code> page. In here we can upload any reverse shell but we don't know where that file is going to be stored. We missed directory fuzzing while enumeration. Let's do it quickly. To do that I used dirsearch here, you can use your fav tool.😈😈</p><pre><code class="language-bash">dirsearch -u http://10.10.10.48/ -w /usr/share/seclists/Discovery/Web-Content/big.txt</code></pre><p>Within the first 5 seconds you will hit the right directory. 😎😎</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-223.png" class="kg-image" alt loading="lazy" width="1000" height="402" srcset="../content/images/size/w600/2021/06/image-223.png 600w, ../content/images/2021/06/image-223.png 1000w" sizes="(min-width: 720px) 720px"></figure><p>Now we know where my file is located after I uploaded. Let's upload the reverse shell now. You can download relevant reverse shell from <a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">here</a> or if you are on <code>kali linux</code> machine, you can use following command to get the reverse shell to your current directory.</p><pre><code class="language-bash"> cp /usr/share/webshells/php/php-reverse-shell.php .
 </code></pre><p>Then open the file and edit the following changes on that file. Remember to change &lt;Your IP&gt; as yours. 🤓🤓 Then save the file.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-224.png" class="kg-image" alt loading="lazy" width="1000" height="468" srcset="../content/images/size/w600/2021/06/image-224.png 600w, ../content/images/2021/06/image-224.png 1000w" sizes="(min-width: 720px) 720px"></figure><p>Now we can upload the reverse shell file. Click the browse button, then select the file and finally click the upload button.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-225.png" class="kg-image" alt loading="lazy" width="855" height="500" srcset="../content/images/size/w600/2021/06/image-225.png 600w, ../content/images/2021/06/image-225.png 855w" sizes="(min-width: 720px) 720px"></figure><p>Now power up netcat listener and navigate to the uploaded file. Mine was <code>http://10.10.10.48/_uploaded/h4rithd.php</code>. I renamed that reverse shell file to <code>h4rithd.php</code>.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-226.png" class="kg-image" alt loading="lazy" width="1000" height="355" srcset="../content/images/size/w600/2021/06/image-226.png 600w, ../content/images/2021/06/image-226.png 1000w" sizes="(min-width: 720px) 720px"></figure><p>You can use <code>python3 -c 'import pty;pty.spawn("/bin/bash")'</code> to beatify the <code>www-data</code> shell. But we are landed on to <code>www-data</code> , which means we don't have much power here. Let's enumerate again.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-227.png" class="kg-image" alt loading="lazy" width="483" height="314"></figure><p>Do you remember that we found a file name called <code>config.php</code> in <code>login.php.swp</code> ? Let's view that file now.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-228.png" class="kg-image" alt loading="lazy" width="1268" height="442" srcset="../content/images/size/w600/2021/06/image-228.png 600w, ../content/images/size/w1000/2021/06/image-228.png 1000w, ../content/images/2021/06/image-228.png 1268w" sizes="(min-width: 720px) 720px"></figure><p>It has some credentials. Now by reading the <code>etc/passwd</code> file we can identify there is a user called john.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-229.png" class="kg-image" alt loading="lazy" width="1358" height="404" srcset="../content/images/size/w600/2021/06/image-229.png 600w, ../content/images/size/w1000/2021/06/image-229.png 1000w, ../content/images/2021/06/image-229.png 1358w" sizes="(min-width: 720px) 720px"></figure><p>Let's try to login SSH as john using <code>thisisagoodpassword</code> password! And you will be able to view the user flag after that. 🤗🤗</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-230.png" class="kg-image" alt loading="lazy" width="1358" height="332" srcset="../content/images/size/w600/2021/06/image-230.png 600w, ../content/images/size/w1000/2021/06/image-230.png 1000w, ../content/images/2021/06/image-230.png 1358w" sizes="(min-width: 720px) 720px"></figure><p>Now, time to grab the root flag.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-231.png" class="kg-image" alt loading="lazy" width="640" height="314" srcset="../content/images/size/w600/2021/06/image-231.png 600w, ../content/images/2021/06/image-231.png 640w"></figure><hr><h2 id="03-privilege-escalation"><strong><strong>03. Privilege Escalation</strong></strong></h2><p>Now we have john's password. Let's check what command we can run as super user in here.</p><pre><code class="language-bash">sudo -l</code></pre><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-232.png" class="kg-image" alt loading="lazy" width="1000" height="301" srcset="../content/images/size/w600/2021/06/image-232.png 600w, ../content/images/2021/06/image-232.png 1000w" sizes="(min-width: 720px) 720px"></figure><p>We can run  <code>find</code> command as sudo. By looking at the <a href="https://man7.org/linux/man-pages/man1/find.1.html">man page</a> for <code>find</code> command, we can identify the uses of  <code>-exec</code> commands. Let's try to get the advantage using that.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-233.png" class="kg-image" alt loading="lazy" width="863" height="376" srcset="../content/images/size/w600/2021/06/image-233.png 600w, ../content/images/2021/06/image-233.png 863w" sizes="(min-width: 720px) 720px"></figure><p>So the command will be like this.👇👇</p><pre><code class="language-bash">sudo /usr/bin/find /bin -exec /bin/bash \;</code></pre><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-234.png" class="kg-image" alt loading="lazy" width="1358" height="442" srcset="../content/images/size/w600/2021/06/image-234.png 600w, ../content/images/size/w1000/2021/06/image-234.png 1000w, ../content/images/2021/06/image-234.png 1358w" sizes="(min-width: 720px) 720px"></figure><p>And..... we got the root flag. 🤘🤘</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-235.png" class="kg-image" alt loading="lazy" width="831" height="713" srcset="../content/images/size/w600/2021/06/image-235.png 600w, ../content/images/2021/06/image-235.png 831w" sizes="(min-width: 720px) 720px"></figure><hr><p>So now we have completed the Starting point path. From the beginning to the end of the story; we learned a lot of tools, methods and also we tackled with many kinds of machines and vulnerabilities.  Overall this was simple but the journey was not that easy. If someone asked me to choose the best one among those boxes I would choose the <a href="https://h4rithd.com/blog/starting-point-htb-pathfinder-walkthrough/index.html">Pathfinder</a>. 🤤🤤</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-236.png" class="kg-image" alt loading="lazy" width="1102" height="777" srcset="../content/images/size/w600/2021/06/image-236.png 600w, ../content/images/size/w1000/2021/06/image-236.png 1000w, ../content/images/2021/06/image-236.png 1102w" sizes="(min-width: 720px) 720px"></figure><p>At the end, you know how to play <strong>HackTheBox </strong>and what type of vulnerabilities and techniques which can be used to gain access to the machines. Thus we can play rest of the active machines now.🤝🤝</p><p><strong>Happy Hacking !!!</strong></p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-237.png" class="kg-image" alt loading="lazy" width="410" height="501"></figure><p>I’ll see you on the next retired machine! 🙋‍♂️🙋‍♂️</p><p><strong><strong>Find me on </strong></strong><a href="https://twitter.com/ShapManasick" rel="noopener noreferrer">@twitter</a></p>
                <section class="m-tags in-post">
                  <h3 class="m-submenu-title">Tags</h3>
                  <ul>
                      <li>
                        <a href="../tag/starting-point-htb/index.html" title="Starting Point Walkthrough">Starting Point Walkthrough</a>
                      </li>
                      <li>
                        <a href="../tag/base-walkthrough/index.html" title="Base Walkthrough">Base Walkthrough</a>
                      </li>
                      <li>
                        <a href="../tag/h4rithd/index.html" title="h4rithd">h4rithd</a>
                      </li>
                      <li>
                        <a href="../tag/harith-dilshan/index.html" title="Harith Dilshan">Harith Dilshan</a>
                      </li>
                  </ul>
                </section>
            </div>
          </div>
        </div>
        
        <section class="m-author">
          <div class="m-author__content">
            <div class="m-author__picture">
              <a href="../author/h4rithd/index.html" class="m-author-picture" aria-label="Harith Dilshan">
                  <div style="background-image: url(../content/images/2021/06/ProfilePic.jpg);"></div>
              </a>
            </div>
            <div class="m-author__info">
              <h4 class="m-author__name">
                <a href="../author/h4rithd/index.html">Harith Dilshan</a>
              </h4>
                <p class="m-author__bio">👨‍🎓 Graduated at SLIIT specialized in Cyber Security 👷‍♂️ Working at Dialog Axiata</p>
              <ul class="m-author-links">
                  <li>
                    <a href="https://h4rithd.com/" target="_blank" rel="noopener" aria-label="Website">
                      <span class="icon-globe" aria-hidden="true"></span>
                    </a>
                  </li>
                  <li>
                    <a href="https://twitter.com/@h4rithd" target="_blank" rel="noopener" aria-label="Twitter">
                      <span class="icon-twitter" aria-hidden="true"></span>
                    </a>
                  </li>
              </ul>
            </div>
          </div>
        </section>
          <section class="m-recommended">
            <div class="l-wrapper in-recommended">
              <h3 class="m-section-title in-recommended">Recommended for you</h3>
              <div class="m-recommended-articles">
                <div class="m-recommended-slider glide js-recommended-slider">
                  <div class="glide__track" data-glide-el="track">
                    <div class="glide__slides">
                      
    <div class="m-recommended-slider__item glide__slide">
  <article class="m-article-card  post tag-starting-point-htb tag-markup-walkthrough tag-h4rithd tag-harith-dilshan">
    <div class="m-article-card__picture">
      <a href="../starting-point-htb-markup-walkthrough/index.html" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="../content/images/size/w600/2021/06/MarkupBG.jpg" loading="lazy" alt="">
      <a href="../author/h4rithd/index.html" class="m-article-card__author js-tooltip" aria-label="Harith Dilshan" data-tippy-content="Posted by Harith Dilshan ">
          <div style="background-image: url(../content/images/size/w100/2021/06/ProfilePic.jpg);"></div>
      </a>
    </div>
      <div class="m-article-card__info">
        <a href="../tag/starting-point-htb/index.html" class="m-article-card__tag">Starting Point Walkthrough</a>
      <a href="../starting-point-htb-markup-walkthrough/index.html" class="m-article-card__info-link" aria-label="Markup Walkthrough">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Markup Walkthrough">
            Markup Walkthrough
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>4 days ago</span>
          <span>&bull;</span>
          <span>7 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
    <div class="m-recommended-slider__item glide__slide">
  <article class="m-article-card  post tag-starting-point-htb tag-guard-walkthrough tag-h4rithd tag-harith-dilshan">
    <div class="m-article-card__picture">
      <a href="../starting-point-htb-guard-walkthrough/index.html" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="../content/images/size/w600/2021/06/GurdBG.jpg" loading="lazy" alt="">
      <a href="../author/h4rithd/index.html" class="m-article-card__author js-tooltip" aria-label="Harith Dilshan" data-tippy-content="Posted by Harith Dilshan ">
          <div style="background-image: url(../content/images/size/w100/2021/06/ProfilePic.jpg);"></div>
      </a>
    </div>
      <div class="m-article-card__info">
        <a href="../tag/starting-point-htb/index.html" class="m-article-card__tag">Starting Point Walkthrough</a>
      <a href="../starting-point-htb-guard-walkthrough/index.html" class="m-article-card__info-link" aria-label="Guard Walkthrough">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Guard Walkthrough">
            Guard Walkthrough
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>4 days ago</span>
          <span>&bull;</span>
          <span>5 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
    <div class="m-recommended-slider__item glide__slide">
  <article class="m-article-card  post tag-starting-point-htb tag-included-walkthrough tag-h4rithd tag-harith-dilshan">
    <div class="m-article-card__picture">
      <a href="../starting-point-htb-included-walkthrough/index.html" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="../content/images/size/w600/2021/06/IncludedBG.jpg" loading="lazy" alt="">
      <a href="../author/h4rithd/index.html" class="m-article-card__author js-tooltip" aria-label="Harith Dilshan" data-tippy-content="Posted by Harith Dilshan ">
          <div style="background-image: url(../content/images/size/w100/2021/06/ProfilePic.jpg);"></div>
      </a>
    </div>
      <div class="m-article-card__info">
        <a href="../tag/starting-point-htb/index.html" class="m-article-card__tag">Starting Point Walkthrough</a>
      <a href="../starting-point-htb-included-walkthrough/index.html" class="m-article-card__info-link" aria-label="Included Walkthrough">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Included Walkthrough">
            Included Walkthrough
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>8 days ago</span>
          <span>&bull;</span>
          <span>7 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
                    </div>
                  </div>
                  <div data-glide-el="controls" class="glide__arrows js-controls">
                    <button data-glide-dir="<" class="m-icon-button filled in-recommended-articles glide-prev" aria-label="Previous">
                      <span class="icon-arrow-left" aria-hidden="true"></span>
                    </button>
                    <button data-glide-dir=">" class="m-icon-button filled in-recommended-articles glide-next" aria-label="Next">
                      <span class="icon-arrow-right" aria-hidden="true"></span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>
    </div>
  </article>
</main>



    
<div class="m-search js-search" role="dialog" aria-modal="true" aria-label="Search">
  <button class="m-icon-button outlined as-close-search js-close-search" aria-label="Close search">
    <span class="icon-close" aria-hidden="true"></span>
  </button>
  <div class="m-search__content">
    <form class="m-search__form">
      <div class="pos-relative">
        <span class="icon-search m-search-icon" aria-hidden="true"></span>
        <label for="search-input" class="sr-only">
          Type to search
        </label>
        <input id="search-input" type="text" class="m-input in-search js-input-search" placeholder="Type to search">
      </div>
    </form>
    <div class="js-search-results hide"></div>
    <p class="m-not-found align-center hide js-no-results">
      No results for your search, please try with something else.
    </p>
  </div>
</div>

    
<footer class="m-footer">
  <div class="m-footer__content">
    <nav class="m-footer-social">
        <a href="https://www.facebook.com/ShapManasick/" target="_blank" rel="noopener" aria-label="Facebook">
          <span class="icon-facebook" aria-hidden="true"></span>
        </a>
        <a href="https://twitter.com/h4rithd" target="_blank" rel="noopener" aria-label="Twitter">
          <span class="icon-twitter" aria-hidden="true"></span>
        </a>
      <a href="https://h4rithd.com/blog/rss" aria-label="RSS">
        <span class="icon-rss" aria-hidden="true"></span>
      </a>
    </nav>
    <p class="m-footer-copyright">
      <span>h4rithd.com &copy; 2021</span>  
    </p>
    <p class="m-footer-copyright jslicense">
     <span>Published with 🖤  </span>
    </p>
  </div>
</footer>

    
    <script crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver%2CPromise%2CArray.prototype.includes%2CString.prototype.endsWith%2CString.prototype.startsWith%2CObject.assign%2CNodeList.prototype.forEach"></script>
    <script defer src="../assets/js/manifest.js%3Fv=f9d12b7c78"></script>
    <script defer src="../assets/js/vendor/content-api.min.js%3Fv=f9d12b7c78"></script>
    <script defer src="../assets/js/vendor.js%3Fv=f9d12b7c78"></script>
    <script defer src="../assets/js/app.js%3Fv=f9d12b7c78"></script>

      <script defer src="../assets/js/post.js%3Fv=f9d12b7c78"></script>


    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-python.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-bash.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-sql.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-powershell.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-ruby.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-csharp.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-cpp.min.js"></script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/toolbar/prism-toolbar.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre[class*=language-]').forEach(function (node) {
            node.classList.add('line-numbers');
        });
        Prism.highlightAll();
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121547351-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121547351-1');
</script>
  </body>
</html>
