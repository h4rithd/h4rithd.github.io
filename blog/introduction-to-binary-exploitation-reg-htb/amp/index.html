<!DOCTYPE html>
<html ‚ö°>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <title>Introduction to Binary Exploitation | Reg HTB</title>

    <meta name="description" content="Interested in binary exploitation? Then welcome to beginners level  0x01...">
    <link rel="icon" href="../../content/images/2021/06/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="../index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="h4rithd.com">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Introduction to Binary Exploitation | Reg HTB">
    <meta property="og:description" content="Interested in binary exploitation? Then welcome to beginners level  0x01...">
    <meta property="og:url" content="https://h4rithd.com/blog/introduction-to-binary-exploitation-reg-htb/">
    <meta property="og:image" content="https://h4rithd.com/blog/content/images/2021/06/Binary101.jpg">
    <meta property="article:published_time" content="2021-06-19T13:33:07.000Z">
    <meta property="article:modified_time" content="2021-06-19T13:33:07.000Z">
    <meta property="article:tag" content="Binary Exploitation">
    <meta property="article:tag" content="h4rithd">
    <meta property="article:tag" content="Harith Dilshan">
    
    <meta property="article:publisher" content="https://www.facebook.com/ShapManasick/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Introduction to Binary Exploitation | Reg HTB">
    <meta name="twitter:description" content="Interested in binary exploitation? Then welcome to beginners level  0x01...">
    <meta name="twitter:url" content="https://h4rithd.com/blog/introduction-to-binary-exploitation-reg-htb/">
    <meta name="twitter:image" content="https://h4rithd.com/blog/content/images/2021/06/Binary101.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Harith Dilshan">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Binary Exploitation, h4rithd, Harith Dilshan">
    <meta name="twitter:site" content="@h4rithd">
    <meta name="twitter:creator" content="@h4rithd">
    <meta property="og:image:width" content="1920">
    <meta property="og:image:height" content="1035">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "h4rithd.com",
        "url": "https://h4rithd.com/blog/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://h4rithd.com/blog/content/images/2021/06/Logo.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Harith Dilshan",
        "image": {
            "@type": "ImageObject",
            "url": "https://h4rithd.com/blog/content/images/2021/06/ProfilePic.jpg",
            "width": 2000,
            "height": 2000
        },
        "url": "https://h4rithd.com/blog/author/h4rithd/",
        "sameAs": [
            "https://h4rithd.com/",
            "https://twitter.com/h4rithd"
        ]
    },
    "headline": "Introduction to Binary Exploitation | Reg HTB",
    "url": "https://h4rithd.com/blog/introduction-to-binary-exploitation-reg-htb/",
    "datePublished": "2021-06-19T13:33:07.000Z",
    "dateModified": "2021-06-19T13:33:07.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://h4rithd.com/blog/content/images/2021/06/Binary101.jpg",
        "width": 1920,
        "height": 1035
    },
    "keywords": "Binary Exploitation, h4rithd, Harith Dilshan",
    "description": "What I know about the Binary Exploitation - 0x101\n\nFirst of all, I&#x27;m not so fit to the Binary Exploitation world and also I have less experience in it. Anyway I want to learn more about the binary exploitation, but before that I thought to outline what I know here. So If there is anything wrong, please be kind to reach me out. ü§•ü§•\n\nHere I&#x27;m not going to explain more details about basic registers, stack frames and assembly codes. You can do some self studies and learn such things. Without wastin",
    "mainEntityOfPage": "https://h4rithd.com/blog/introduction-to-binary-exploitation-reg-htb/"
}
    </script>

    <meta name="generator" content="Ghost 5.73">
    <link rel="alternate" type="application/rss+xml" title="h4rithd.com" href="../../rss/index.html">

    <style amp-custom>
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    html {
        overflow-x: hidden;
        overflow-y: scroll;
        font-size: 62.5%;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    body {
        min-height: 100vh;
        margin: 0;
        padding: 0;
        color: #3a4145;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.7rem;
        line-height: 1.55em;
        font-weight: 400;
        font-style: normal;
        background: #fff;
        scroll-behavior: smooth;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    p,
    ul,
    ol,
    li,
    dl,
    dd,
    hr,
    pre,
    form,
    table,
    video,
    figure,
    figcaption,
    blockquote {
        margin: 0;
        padding: 0;
    }

    ul[class],
    ol[class] {
        padding: 0;
        list-style: none;
    }

    img {
        display: block;
        max-width: 100%;
    }

    input,
    button,
    select,
    textarea {
        font: inherit;
        -webkit-appearance: none;
    }

    fieldset {
        margin: 0;
        padding: 0;
        border: 0;
    }

    label {
        display: block;
        font-size: 0.9em;
        font-weight: 700;
    }

    hr {
        position: relative;
        display: block;
        width: 100%;
        height: 1px;
        border: 0;
        border-top: 1px solid currentcolor;
        opacity: 0.1;
    }

    ::selection {
        text-shadow: none;
        background: #cbeafb;
    }

    mark {
        background-color: #fdffb6;
    }

    small {
        font-size: 80%;
    }

    sub,
    sup {
        position: relative;
        font-size: 75%;
        line-height: 0;
        vertical-align: baseline;
    }
    sup {
        top: -0.5em;
    }
    sub {
        bottom: -0.25em;
    }

    ul li + li {
        margin-top: 0.6em;
    }

    a {
        color: var(--ghost-accent-color, #1292EE);
        text-decoration-skip-ink: auto;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 0;
        font-weight: 700;
        color: #121212;
        line-height: 1.4em;
    }

    h1 {
        font-size: 3.4rem;
        line-height: 1.1em;
    }

    h2 {
        font-size: 2.4rem;
        line-height: 1.2em;
    }

    h3 {
        font-size: 1.8rem;
    }

    h4 {
        font-size: 1.7rem;
    }

    h5 {
        font-size: 1.6rem;
    }

    h6 {
        font-size: 1.6rem;
    }

    amp-img {
        height: 100%;
        width: 100%;
        max-width: 100%;
        max-height: 100%;
    }

    amp-img img {
        object-fit: cover;
    }
    
    amp-youtube {
        height: calc(100vw / 1.78);
        width: 100vw;
        position: relative;
    }

    amp-youtube img {
        position: absolute;
    }

    .page-header {
        padding: 50px 5vmin 30px;
        text-align: center;
        font-size: 2rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .page-header a {
        color: #121212;
        font-weight: 700;
        text-decoration: none;
        font-size: 1.6rem;
        letter-spacing: -0.1px;
    }

    .post {
        max-width: 680px;
        margin: 0 auto;
    }

    .post-header {
        margin: 0 5vmin 5vmin;
        text-align: center;
    }

    .post-meta {
        margin: 1rem 0 0 0;
        text-transform: uppercase;
        color: #738a94;
        font-weight: 500;
        font-size: 1.3rem;
    }

    .post-image {
        margin: 0 0 5vmin;
    }

    .post-image img {
        display: block;
        width: 100%;
        height: auto;
    }

    .post-content {
        padding: 0 5vmin;
    }

    .post-content > * + * {
        margin-top: 1.5em;
    }

    .post-content [id]:not(:first-child) {
        margin: 2em 0 0;
    }

    .post-content > [id] + * {
        margin-top: 1rem;
    }

    .post-content [id] + .kg-card,
    .post-content blockquote + .kg-card {
        margin-top: 40px;
    }

    .post-content > ul,
    .post-content > ol,
    .post-content > dl {
        padding-left: 1.9em;
    }

    .post-content hr {
        margin-top: 40px;
    }

    .post .post-content hr + * {
        margin-top: 40px;
    }

    .post-content amp-img {
        background-color: #f8f8f8;
    }

    .post-content blockquote {
        position: relative;
        font-style: italic;
    }

    .post-content blockquote::before {
        content: "";
        position: absolute;
        left: -1.5em;
        top: 0;
        bottom: 0;
        width: 0.3rem;
        background: var(--ghost-accent-color, #1292EE);
    }

    .post-content blockquote.kg-blockquote-alt {
        font-size: 1.2em;
        font-style: italic;
        line-height: 1.6em;
        text-align: center;
        color: #738a94;
        padding: 0.75em 3em 1.25em;
    }

    .post-content blockquote.kg-blockquote-alt::before {
        display: none;
    }

    .post-content :not(.kg-card):not([id]) + .kg-card {
        margin-top: 40px;
    }

    .post-content .kg-card + :not(.kg-card) {
        margin-top: 40px;
    }

    .kg-card figcaption {
        padding: 1.5rem 1.5rem 0;
        text-align: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.4em;
        opacity: 0.6;
    }

    .kg-card figcaption strong {
        color: rgba(0,0,0,0.8);
    }

    .post-content :not(pre) code {
        vertical-align: middle;
        padding: 0.15em 0.4em 0.15em;
        border: #e1eaef 1px solid;
        font-weight: 400;
        font-size: 0.9em;
        line-height: 1em;
        color: #15171a;
        background: #f0f6f9;
        border-radius: 0.25em;
    }

    .post-content > pre {
        overflow: scroll;
        padding: 16px 20px;
        color: #fff;
        background: #1F2428;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0,0,0,.1), 0 0 1px rgba(0,0,0,.4);
    }

    .kg-embed-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }

    .kg-image-card img {
        margin: auto;
    }

    .kg-gallery-card + .kg-gallery-card {
        margin-top: 0.75em;
    }

    .kg-gallery-container {
        position: relative;
    }

    .kg-gallery-row {
        display: flex;
        flex-direction: row;
        justify-content: center;
    }

    .kg-gallery-image {
        width: 100%;
        height: 100%;
    }

    .kg-gallery-row:not(:first-of-type) {
        margin: 0.75em 0 0 0;
    }

    .kg-gallery-image:not(:first-of-type) {
        margin: 0 0 0 0.75em;
    }

    .kg-bookmark-card,
    .kg-bookmark-publisher {
        position: relative;
    }

    .kg-bookmark-container,
    .kg-bookmark-container:hover {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row-reverse;
        color: currentColor;
        background: rgba(255,255,255,0.6);
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        text-decoration: none;
        border-radius: 3px;
        box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.4);
        overflow: hidden;
    }

    .kg-bookmark-content {
        flex-basis: 0;
        flex-grow: 999;
        padding: 20px;
        order: 1;
    }

    .kg-bookmark-title {
        font-weight: 600;
        font-size: 1.5rem;
        line-height: 1.3em;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        max-height: 45px;
        margin: 0.5em 0 0 0;
        font-size: 1.4rem;
        line-height: 1.55em;
        overflow: hidden;
        opacity: 0.8;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .kg-bookmark-metadata {
        margin-top: 20px;
    }

    .kg-bookmark-metadata {
        display: flex;
        align-items: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.3em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
    }

    .kg-bookmark-metadata amp-img {
        width: 18px;
        height: 18px;
        max-width: 18px;
        max-height: 18px;
        margin-right: 10px;
    }

    .kg-bookmark-thumbnail {
        display: flex;
        flex-basis: 20rem;
        flex-grow: 1;
        justify-content: flex-end;
    }

    .kg-bookmark-thumbnail amp-img {
        max-height: 200px;
    }

    .kg-bookmark-author {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .kg-bookmark-publisher::before {
        content: "‚Ä¢";
        margin: 0 .5em;
    }

    .kg-toggle-card-icon {
        display: none;
    }

    .kg-toggle-content {
        margin-top: 0.8rem;
    }

    .kg-product-card-container {
        background: transparent;
        padding: 20px;
        width: 100%;
        border-radius: 5px;
        box-shadow: inset 0 0 0 1px rgb(124 139 154 / 25%);
    }

    .kg-product-card-description p {
        margin-top: 1.5em;
    }

    .kg-product-card-description ul {
        margin-left: 24px;
    }

    .kg-product-card-title {
        font-size: 1.9rem;
        font-weight: 700;
    }

    .kg-product-card-rating-star {
        height: 28px;
        width: 20px;
        margin-right: 2px;
    }

    .kg-product-card-rating-star svg {
    width: 16px;
    height: 16px;
    fill: currentColor;
    opacity: 0.15;
    }

    .kg-product-card-rating-active.kg-product-card-rating-star svg {
    opacity: 1;
    }

    .kg-nft-card-container {
        position: relative;
        display: flex;
        flex: auto;
        flex-direction: column;
        text-decoration: none;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.4rem;
        font-weight: 400;
        box-shadow: 0 2px 6px -2px rgb(0 0 0 / 10%), 0 0 1px rgb(0 0 0 / 40%);
        width: 100%;
        max-width: 512px;
        color: #15212A;
        background: #fff;
        border-radius: 5px;
        transition: none;
        margin: 0 auto;
    }

    .kg-nft-metadata {
        padding: 2.0rem;
    }

    .kg-nft-image-container {
        position: relative;
    }

    .kg-nft-image {
        display: flex;
        border-radius: 5px 5px 0 0;
    }

    .kg-nft-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 20px;
    }

    .kg-nft-header h4.kg-nft-title {
        font-size: 1.9rem;
        font-weight: 700;
        margin: 0;
        color: #15212A;
    }

    .kg-nft-header amp-img {
        max-width: 114px;
        max-height: 26px;
    }

    .kg-nft-opensea-logo {
        margin-top: 2px;
        width: 100px;
    }

    .kg-nft-creator {
        font-family: inherit;
        color: #95A1AD;
    }

    .kg-nft-creator span {
        font-weight: 500;
        color: #15212A;
    }

    .kg-nft-card p.kg-nft-description {
        font-size: 1.4rem;
        line-height: 1.4em;
        margin: 2.0rem 0 0;
        color: #222;
    }

    .kg-button-card {
        display: flex;
        position: static;
        align-items: center;
        width: 100%;
        justify-content: center;
    }

    .kg-btn {
        display: flex;
        position: static;
        align-items: center;
        padding: 0 2.0rem;
        height: 4.0rem;
        line-height: 4.0rem;
        font-size: 1.65rem;
        font-weight: 600;
        text-decoration: none;
        border-radius: 5px;
        transition: opacity 0.2s ease-in-out;
    }

    .kg-btn:hover {
        opacity: 0.85;
    }

    .kg-btn-accent {
        background-color: var(--ghost-accent-color, #1292EE);
        color: #fff;
    }

    .kg-callout-card {
        display: flex;
        padding: 20px 28px;
        border-radius: 3px;
    }

    .kg-callout-card-grey {
        background: rgba(124, 139, 154, 0.13);
    }

    .kg-callout-card-white {
        background: transparent;
        box-shadow: inset 0 0 0 1px rgba(124, 139, 154, 0.25);
    }

    .kg-callout-card-blue {
        background: rgba(33, 172, 232, 0.12);
    }

    .kg-callout-card-green {
        background: rgba(52, 183, 67, 0.12);
    }

    .kg-callout-card-yellow {
        background: rgba(240, 165, 15, 0.13);
    }

    .kg-callout-card-red {
        background: rgba(209, 46, 46, 0.11);
    }

    .kg-callout-card-pink {
        background: rgba(225, 71, 174, 0.11);
    }

    .kg-callout-card-purple {
        background: rgba(135, 85, 236, 0.12);
    }

    .kg-callout-card-accent {
        background: var(--ghost-accent-color);
        color: #fff;
    }

    .kg-callout-card-accent a {
        color: #fff;
    }

    .kg-callout-emoji {
        padding-right: 16px;
        line-height: 1.3;
        font-size: 1.25em;
    }

    .kg-header-card {
        padding: 6em 3em;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
    }

    .kg-header-card.kg-size-small {
        padding-top: 4em;
        padding-bottom: 4em;
    }

    .kg-header-card.kg-size-large {
        padding-top: 12em;
        padding-bottom: 12em;
    }

    .kg-header-card.kg-width-full {
        padding-left: 4em;
        padding-right: 4em;
    }

    .kg-header-card.kg-align-left {
        text-align: left;
        align-items: flex-start;
    }

    .kg-header-card.kg-style-dark {
        background: #15171a;
        color: #ffffff;
    }

    .kg-header-card.kg-style-light {
        color: #15171a;
        border: 1px solid rgba(124, 139, 154, 0.25);
        border-width: 1px 0;
    }

    .kg-header-card.kg-style-accent {
        background-color: var(--ghost-accent-color);
    }

    .kg-header-card.kg-style-image {
        background-color: #e7e7eb;
        background-size: cover;
        background-position: center center;
    }

    .kg-header-card h2 {
        font-size: 4em;
        font-weight: 700;
        line-height: 1.1em;
        margin: 0;
    }

    .kg-header-card h2 strong {
        font-weight: 800;
    }

    .kg-header-card.kg-size-small h2 {
        font-size: 3em;
    }

    .kg-header-card.kg-size-large h2 {
        font-size: 5em;
    }

    .kg-header-card h3 {
        font-size: 1.25em;
        font-weight: 500;
        line-height: 1.3em;
        margin: 0;
    }

    .kg-header-card h3 strong {
        font-weight: 600;
    }

    .kg-header-card.kg-size-small h3 {
        font-size: 1em;
    }

    .kg-header-card.kg-size-large h3 {
        font-size: 1.5em;
    }

    .kg-header-card:not(.kg-style-light) h2,
    .kg-header-card:not(.kg-style-light) h3 {
        color: #ffffff;
    }

    .kg-header-card a.kg-header-card-button {
        display: flex;
        position: static;
        align-items: center;
        padding: 0 1.2em;
        height: 2.4em;
        line-height: 1em;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-size: 0.95em;
        font-weight: 600;
        text-decoration: none;
        border-radius: 5px;
        transition: opacity 0.2s ease-in-out;
        background-color: var(--ghost-accent-color);
        color: #ffffff;
        margin: 1.75em 0 0;
    }

    .kg-header-card a.kg-header-card-button:hover {
        opacity: 0.85;
    }

    .kg-header-card.kg-size-large a.kg-header-card-button {
        margin-top: 2em;
    }

    .kg-header-card.kg-size-small a.kg-header-card-button {
        margin-top: 1.5em;
    }

    .kg-header-card.kg-style-image a.kg-header-card-button,
    .kg-header-card.kg-style-dark a.kg-header-card-button {
        background: #ffffff;
        color: #15171a;
    }

    .kg-header-card.kg-style-accent a.kg-header-card-button {
        background: #ffffff;
        color: var(--ghost-accent-color);
    }

    .kg-audio-card {
        display: flex;
        width: 100%;
        box-shadow: inset 0 0 0 1px rgba(124, 139, 154, 0.25);
    }

    .kg-audio-thumbnail {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 80px;
        min-width: 80px;
        height: 80px;
        background: transparent;
        object-fit: cover;
        aspect-ratio: 1/1;
        border-radius: 3px 0 0 3px;
    }

    .kg-audio-thumbnail.placeholder {
        background: var(--ghost-accent-color);
    }

    .kg-audio-thumbnail.placeholder svg {
        width: 24px;
        height: 24px;
        fill: white;
    }

    .kg-audio-player-container {
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        width: 100%;
        --seek-before-width: 0%;
        --volume-before-width: 100%;
        --buffered-width: 0%;
    }

    .kg-audio-title {
        width: 100%;
        padding: 8px 12px 0;
        border: none;
        font-family: inherit;
        font-size: 1.1em;
        font-weight: 700;
        background: transparent;
    }

    .kg-audio-player {
        display: none;
    }

    .kg-width-full.kg-card-hascaption {
        display: grid;
        grid-template-columns: inherit;
    }

    .post-content table {
        border-collapse: collapse;
        width: 100%;
    }

    .post-content th {
        padding: 0.5em 0.8em;
        text-align: left;
        font-size: .75em;
        text-transform: uppercase;
    }

    .post-content td {
        padding: 0.4em 0.7em;
    }

    .post-content tbody tr:nth-child(2n + 1) {
        background-color: rgba(0,0,0,0.1);
        padding: 1px;
    }

    .post-content tbody tr:nth-child(2n + 2) td:last-child {
        box-shadow:
            inset 1px 0 rgba(0,0,0,0.1),
            inset -1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:nth-child(2n + 2) td {
        box-shadow: inset 1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:last-child {
        border-bottom: 1px solid rgba(0,0,0,.1);
    }

    .page-footer {
        padding: 60px 5vmin;
        margin: 60px auto 0;
        text-align: center;
        background-color: #f8f8f8;
    }

    .page-footer h3 {
        margin: 0.5rem 0 0 0;
    }

    .page-footer p {
        max-width: 500px;
        margin: 1rem auto 1.5rem;
        font-size: 1.7rem;
        line-height: 1.5em;
        color: rgba(0,0,0,0.6)
    }

    .powered {
        display: inline-flex;
        align-items: center;
        margin: 30px 0 0;
        padding: 6px 9px 6px 6px;
        border: rgba(0,0,0,0.1) 1px solid;
        font-size: 12px;
        line-height: 12px;
        letter-spacing: -0.2px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-weight: 500;
        color: #222;
        text-decoration: none;
        background: #fff;
        border-radius: 6px;
    }

    .powered svg {
        height: 16px;
        width: 16px;
        margin: 0 6px 0 0;
    }

    @media (max-width: 600px) {
        body {
            font-size: 1.6rem;
        }
        h1 {
            font-size: 3rem;
        }

        h2 {
            font-size: 2.2rem;
        }
    }

    @media (max-width: 400px) {
        h1 {
            font-size: 2.6rem;
            line-height: 1.15em;
        }
        h2 {
            font-size: 2rem;
            line-height: 1.2em;
        }
        h3 {
            font-size: 1.7rem;
        }
    }

    :root {--ghost-accent-color: #0065a3;}
    </style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    <script async custom-element="amp-anim" src="https://cdn.ampproject.org/v0/amp-anim-0.1.js"></script>

</head>

<body class="amp-template">
    <header class="page-header">
        <a href="../../index.html">
                <amp-img class="site-icon" src="https://h4rithd.com/blog/content/images/2021/06/favicon.ico" width="50" height="50" layout="fixed" alt="h4rithd.com"></amp-img>
        </a>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Introduction to Binary Exploitation | Reg HTB</h1>
                <section class="post-meta">
                    Harith Dilshan -
                    <time class="post-date" datetime="2021-06-19">19 Jun 2021</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="https://h4rithd.com/blog/content/images/2021/06/Binary101.jpg" width="600" height="340" layout="responsive" 
                alt="Introduction to Binary Exploitation | Reg HTB"
                ></amp-img>
            </figure>
            <section class="post-content">

                <p>What I know about the Binary Exploitation - 0x101</p><hr></hr><p>First of all, I'm not so fit to the Binary Exploitation world and also I have less experience in it. Anyway I want to learn more about the binary exploitation, but before that I thought to outline what I know here. So If there is anything wrong, please be kind to reach me out. ü§•ü§•</p><p>Here I'm not going to explain more details about basic registers, stack frames and assembly codes. You can do some self studies and learn such things. Without wasting time on google click <a href="https://azeria-labs.com/functions-and-the-stack-part-7/?ref=172.16.77.130" rel="noopener noreferrer">here </a>to know detailed explanation about the Functions and Stack.üòÅüòÅ</p><p>Enough talks ü§êü§ê Let me put in my two-penny worth..</p>
<div class="elfsight-app-a4de7430-6c0c-44b8-aada-9b9ac759e396"></div><p>Here I chose the binary file from <strong><a href="https://app.hackthebox.eu/challenges/170?ref=172.16.77.130">HackTheBox</a> </strong>Reg challenge. You can download that binary from <a href="https://mega.nz/file/0TZmzLIJ?ref=172.16.77.130#rUoB8lApS-s6QJBBqzk5ZtXHjPjlroMfbn3twVBT1No">here</a> also. Verify the md5 after downloading the file.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-329.png" class="kg-image" width="1290" height="332" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-329.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-329.png 1000w, https://h4rithd.com/blog/content/images/2021/06/image-329.png 1290w" layout="responsive"></amp-img></figure><p>Now let's decompress the zip file. To do that we can use the unzip command. Then it will ask the password. Type <code>hackthebox</code> and hit enter.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-330.png" class="kg-image" width="1470" height="588" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-330.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-330.png 1000w, https://h4rithd.com/blog/content/images/2021/06/image-330.png 1470w" layout="responsive"></amp-img></figure><p>Let's start to tackle with the binary file now. Normally we can do a quick walk around the binary file before we pulling out the big guns to the audience. So first thing first, use <code>file</code> command to check what kind of file we have in the desk.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-331.png" class="kg-image" width="1884" height="404" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-331.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-331.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-331.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-331.png 1884w" layout="responsive"></amp-img></figure><p>The <code>file</code> command output releases that, the <code>reg</code> file is an <strong>ELF(Executable and Linkable Format) 64 bit</strong> binary and it is <strong>not stripped.</strong> What it means is, if the binary file has been complied with <code>gcc's -g</code> flag, that binary file contains the debug information. Generally in <strong>strip </strong>binary, ¬†the debug information is removed to reduce the file size. ü§êü§ê</p><p>Again we have a fancy bash script called <code>checksec</code> to check the properties of executables and kernel security options (like GRSecurity and SELinux). We can execute it by <code>checksec filename</code> and let's have a look at what we've got..</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-332.png" class="kg-image" width="1296" height="516" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-332.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-332.png 1000w, https://h4rithd.com/blog/content/images/2021/06/image-332.png 1296w" layout="responsive"></amp-img></figure><p>The checksec script's results give us very important information about the binary file. I found a blog post which explains each flag in details. Click <a href="https://blog.siphos.be/2011/07/high-level-explanation-on-some-binary-executable-security/?ref=172.16.77.130">here</a> to view that blog. I ¬†have attached a part of it below.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-333.png" class="kg-image" width="1404" height="524" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-333.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-333.png 1000w, https://h4rithd.com/blog/content/images/2021/06/image-333.png 1404w" layout="responsive"></amp-img></figure><p>Now you have some idea about the flags. We can also get those information using <a href="https://rada.re/?ref=172.16.77.130">Radare2</a>. You will learn more about this tool in the future.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-334.png" class="kg-image" width="1842" height="1730" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-334.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-334.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-334.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-334.png 1842w" layout="responsive"></amp-img></figure><p>Then we are done with basic <strong>Static Analysis.</strong> Now, time to go ahead with <strong>Dynamic Analysis</strong>. First, change the permission (<code>chmod +x reg</code>) of the file to executable and then run (<code>./reg</code>) the binary file.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-335.png" class="kg-image" width="1296" height="370" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-335.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-335.png 1000w, https://h4rithd.com/blog/content/images/2021/06/image-335.png 1296w" layout="responsive"></amp-img></figure><p>The binary will ask to <code>Enter your name :</code> and we can enter anything and hit enter. Boom! nothing interesting found at all.üòÇüòÇ</p><p>Since it asks inputs, we can check whether it has buffer overflow vulnerability by entering a large number of buffer as input to the input field. Following python command will generate character "A" 200 times and I redirect that output to the file called <code>input</code> ¬†.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-336.png" class="kg-image" width="1780" height="404" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-336.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-336.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-336.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-336.png 1780w" layout="responsive"></amp-img></figure><p>Now we can give that <code>input</code> file as the input of our binary file.üòµüòµ or we can simply copy above output, then paste and enter to the program when it asks to <code>Enter your name :</code></p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-337.png" class="kg-image" width="1148" height="370" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-337.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-337.png 1000w, https://h4rithd.com/blog/content/images/2021/06/image-337.png 1148w" layout="responsive"></amp-img></figure><p>Yeah! The binary hit the Segmentation fault.</p><figure class="kg-card kg-image-card"><amp-anim src="https://h4rithd.com/blog/content/images/2021/06/unnamed.gif" class="kg-image" width="500" height="281" layout="responsive"></amp-anim></figure><blockquote>"In computing, a segmentation fault or access violation is a fault, or failure condition, raised by hardware with memory protection, notifying an operating system the software has attempted to access a restricted area of memory. On standard x86 computers, this is a form of general protection fault" <a href="https://en.wikipedia.org/wiki/Segmentation_fault?ref=172.16.77.130" rel="noopener noreferrer">source</a></blockquote><p>Simply It means, the program has buffer overflow. Let's pull out the big guns now.üòéüòé</p><p>Here I used <strong>Radare2 </strong>to analyze the binary file first. So... Let's load the binary to the <code>radare2</code></p><pre><code class="language-bash">radare2 ./reg
</code></pre><p>Then type <code>aaa</code> and hit enter to analyze all referenced code. If you have any doubts about what ¬†<code>aaa</code> command exactly does, click <a href="https://reverseengineering.stackexchange.com/questions/19895/radares-aaaa-and-aa-what-does-it-do-exactly?ref=172.16.77.130" rel="noopener noreferrer">here</a>. üëàüëà</p><p>After it's done, analyze progress. We can use <code>afl</code> command to list all the functions in the binary file. Final output will be like this. üëáüëá</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-338.png" class="kg-image" width="1764" height="1474" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-338.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-338.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-338.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-338.png 1764w" layout="responsive"></amp-img></figure><blockquote>Click <a href="https://gist.github.com/williballenthin/6857590dab3e2a6559d7?ref=172.16.77.130">here</a> for Radare2 cheat sheet.</blockquote><p>As you can see here, there are <strong>3 functions</strong> which are very interesting. One is called <code>main</code> , without questions we can say it is the main function of the program. But what about the other two functions? ü§∑‚Äç‚ôÇÔ∏èü§∑‚Äç‚ôÇÔ∏è So let's keep that in the back pocket for a while and move on.</p><p>Now I need to know the program entry points [<code>ie</code>], main address location [<code>iM</code>] and what are the strings [<code>iz</code>] which are inside this binary file.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-339.png" class="kg-image" width="1788" height="884" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-339.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-339.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-339.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-339.png 1788w" layout="responsive"></amp-img></figure><p>Now the progress is pretty interesting. We found two strings called <code>Congratulations!</code> and <code>flag.txt</code></p><p>At this point we can get the idea that there is a function in this binary which contains above two strings and that function will expose the flag as well. Let's keep digging deeper... We can use <code>/</code> and search any string inside this binary file. Let's say you want to know where the <code>Congratulations!</code> string is containing inside the binary, you can run the following command.üëáüëá</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-340.png" class="kg-image" width="1532" height="738" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-340.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-340.png 1000w, https://h4rithd.com/blog/content/images/2021/06/image-340.png 1532w" layout="responsive"></amp-img></figure><p>Not getting enough information. So, let's move on to the <strong>Visual mode</strong> in radare2 by typing <code>V</code> [Uppercase] and hitting enter. Then again use <code>v</code> [lowercase] to switch between select function, variable and xref. Navigation can be done using <code>HJKL</code> or <code>arrow keys</code> and <code>PgUp/PgDown</code> keys. If you are lost, press <code>?</code> to get help.üòãüòã</p><figure class="kg-card kg-image-card"><amp-anim src="https://h4rithd.com/blog/content/images/2021/06/reg01.gif" class="kg-image" width="1920" height="840" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/reg01.gif 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/reg01.gif 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/reg01.gif 1600w, https://h4rithd.com/blog/content/images/2021/06/reg01.gif 1920w" layout="responsive"></amp-anim></figure><p>After digging through the functions we found two interesting points.</p><ul><li>The binary gets the inputs using <code>gets</code> function.</li><li>The string called <code>Congratulations!</code> is inside the <code>sys.winner</code> function.</li></ul><p>First of all, let me tell you a short story about <code>gets</code> . In C Programming Language, it has common vulnerable functions which allow to buffer overflow. Click <a href="https://security.web.cern.ch/recommendations/en/codetools/c.shtml?ref=172.16.77.130" rel="noopener noreferrer"><strong>here</strong> </a>to see more detailed information. And <code>gets</code> also includes above mentioned functions. Let's have a look at <a href="https://man7.org/linux/man-pages/man3/gets.3.html?ref=172.16.77.130" rel="noopener noreferrer">manual </a>page for the command <code>gets</code></p><p>This üëá description from the <a href="https://man7.org/linux/man-pages/man3/gets.3.html?ref=172.16.77.130" rel="noopener noreferrer">manual </a>page says <strong>Never use this function</strong>.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-341.png" class="kg-image" width="757" height="372" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-341.png 600w, https://h4rithd.com/blog/content/images/2021/06/image-341.png 757w" layout="responsive"></amp-img></figure><p>Here is the bug explained simply. If you wish to know more details about that bug, click <a href="https://cwe.mitre.org/data/definitions/242.html?ref=172.16.77.130" rel="noopener noreferrer">here </a>to view CWE-242 (Use of Inherently Dangerous Function)</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-342.png" class="kg-image" width="764" height="262" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-342.png 600w, https://h4rithd.com/blog/content/images/2021/06/image-342.png 764w" layout="responsive"></amp-img></figure><p>The story ends. üòüüòü</p><figure class="kg-card kg-image-card"><amp-anim src="https://h4rithd.com/blog/content/images/2021/06/anigif_enhanced-4100-1441055371-2.gif" class="kg-image" width="500" height="282" layout="responsive"></amp-anim></figure><p>Let's take a look at what's inside the <code>winner</code> function. Select the function using <code>s sys.winner</code> and then use <code>pdf</code> command to see the function disassembly.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-344.png" class="kg-image" width="2560" height="1290" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-344.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-344.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-344.png 1600w, https://h4rithd.com/blog/content/images/size/w2400/2021/06/image-344.png 2400w" layout="responsive"></amp-img></figure><p>All right, the program is opening the file called <code>flag.txt</code> and we have to read that <code>flag.txt</code> by using the advantage of <code>gets</code> function's buffer overflow vulnerability. Cool! üòéüòé</p><p>So now we need to find the <code>instruction pointer</code> which caused the segmentation fault. To do that, I am going to use <strong>GDB</strong>. But since I'm not a master in the assembly world, I used the plugin called <strong>pwndbg . </strong>That makes debugging with GDB suck less.üòÅüòÅ You can download it from <a href="https://github.com/pwndbg/pwndbg?ref=172.16.77.130" rel="noopener noreferrer">here</a>.</p><p>Then we can use following command to open the <code>pwndbg</code> with binary file.</p><pre><code class="language-bash">gdb-pwndbg reg</code></pre><p>We can use <code>run</code> command to run the program inside the <code>pwndbg</code>.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-345.png" class="kg-image" width="1784" height="626" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-345.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-345.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-345.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-345.png 1784w" layout="responsive"></amp-img></figure><p>Also we can use <code>info functions</code> to get all the function information.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-346.png" class="kg-image" width="1672" height="1178" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-346.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-346.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-346.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-346.png 1672w" layout="responsive"></amp-img></figure><p>In the beginning, we used a simple python script to make pattern which included the letter "<strong>A</strong>". But here we can use <code>cyclic</code> command to create string patterns.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-347.png" class="kg-image" width="2560" height="994" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-347.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-347.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-347.png 1600w, https://h4rithd.com/blog/content/images/size/w2400/2021/06/image-347.png 2400w" layout="responsive"></amp-img></figure><p>Let's make a 150 length random string pattern using <code>cyclic 150</code></p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-348.png" class="kg-image" width="1730" height="332" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-348.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-348.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-348.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-348.png 1730w" layout="responsive"></amp-img></figure><p>Then copy the pattern to clipboard, <code>run</code> the binary file and paste the previously copied string pattern when it asks for input. Finally hit enter. <strong>pwndbg </strong>will show everything you need to know.</p><figure class="kg-card kg-image-card"><amp-anim src="https://h4rithd.com/blog/content/images/2021/06/Reg2.gif" class="kg-image" width="1920" height="984" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/Reg2.gif 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/Reg2.gif 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/Reg2.gif 1600w, https://h4rithd.com/blog/content/images/2021/06/Reg2.gif 1920w" layout="responsive"></amp-anim></figure><p>You will see that we have crashed the program and now we need to find at what point we did overflow the instruction pointer (also known as <strong>RIP</strong>)<strong>. </strong>Since this is a 64bit binary, we do not have any pattern on the <strong>RIP. </strong>Therefore, we need to get offset from somewhere else. As you can see here, the Stack Pointer (<strong>RSP</strong>) currently contains a value starting from <code>oaaa</code> and that's the address where the the program is going to jump as next instruction pointer (<strong>RIP</strong>) which was the <strong>return (ret)</strong>.</p><p>Now we need to get the offset value. You can get the offset value in two different ways.</p><ol><li>You can get the last 4 in <strong>RBP </strong>which is <code>naaa</code> in this case and whatever comes after that is our <strong>RIP</strong>.</li><li>Also you can get the first 4 in <strong>RSP </strong>which is <code>oaaa</code> and that is our <strong>RIP</strong>.</li></ol><p>To view the <strong>offset value</strong> we can use <code>cyclic -l &lt;pattern&gt;</code> as follows.üëáüëá</p><figure class="kg-card kg-image-card"><amp-anim src="https://h4rithd.com/blog/content/images/2021/06/Reg3.gif" class="kg-image" width="1160" height="736" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/Reg3.gif 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/Reg3.gif 1000w, https://h4rithd.com/blog/content/images/2021/06/Reg3.gif 1160w" layout="responsive"></amp-anim></figure><p>So now we know the offset value. Thus we have to enter 56 bytes first and then overwrite the Stack Pointer (RSP).</p><p>Let's check if we are correct. Create a fake flag called <code>flag.txt</code> in the current working directory.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-349.png" class="kg-image" width="1362" height="294" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-349.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-349.png 1000w, https://h4rithd.com/blog/content/images/2021/06/image-349.png 1362w" layout="responsive"></amp-img></figure><p>Then we need to find the address of <code>winner</code> function. Again, I used radare2 to get that address.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-350.png" class="kg-image" width="1884" height="1474" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-350.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-350.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-350.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-350.png 1884w" layout="responsive"></amp-img></figure><p>Now let's create the payload using a simple python script. What it dose is, it prints 56 "A"s and then prints the return address of winner function which we need to jump to. Here I used python <code>pwntools</code> to pack that address in <strong>little endian</strong> format. Also you can use <code>struct</code> library to do so.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-351.png" class="kg-image" width="1754" height="332" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-351.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-351.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-351.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-351.png 1754w" layout="responsive"></amp-img></figure><p>Let's check by importing that payload to the binary file as input.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-352.png" class="kg-image" width="1916" height="404" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-352.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-352.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-352.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-352.png 1916w" layout="responsive"></amp-img></figure><p>Voila! we got our fake flag. It means the payload is 100% working. Let's jump to check whether we can use it to remote sever using netcat tool.</p><figure class="kg-card kg-image-card"><amp-img src="https://h4rithd.com/blog/content/images/2021/06/image-353.png" class="kg-image" width="2230" height="404" srcset="https://h4rithd.com/blog/content/images/size/w600/2021/06/image-353.png 600w, https://h4rithd.com/blog/content/images/size/w1000/2021/06/image-353.png 1000w, https://h4rithd.com/blog/content/images/size/w1600/2021/06/image-353.png 1600w, https://h4rithd.com/blog/content/images/2021/06/image-353.png 2230w" layout="responsive"></amp-img></figure><p>Aaaaand it was successful. ü§òü§ò</p><figure class="kg-card kg-image-card"><amp-anim src="https://h4rithd.com/blog/content/images/2021/06/tenor.gif" class="kg-image" width="498" height="277" layout="responsive"></amp-anim></figure><p>I hope you enjoyed the writeup. And if there is anything wrong, please be kind enough to send a <a href="https://forms.gle/ejvMkyY9xaPgassa8?ref=172.16.77.130" rel="noopener noreferrer">feedback </a>because you know, I'm not really matching to the assembly world.ü§ßü§ß</p><p>Next time we will digging into the <code>pwntools</code> library more because it has got more power when it comes to the binary exploitation world. I mean, things can be run as automation and it makes things easier than doing it manually.</p><p>Ciao.üôã‚Äç‚ôÇÔ∏èüôã‚Äç‚ôÇÔ∏è</p><p><strong>Find me on </strong><a href="https://twitter.com/ShapManasick?ref=172.16.77.130" rel="noopener noreferrer">@twitter</a></p>

            </section>

        </article>
    </main>
    <footer class="page-footer">
            <amp-img class="site-icon" src="https://h4rithd.com/blog/content/images/2021/06/favicon.ico" width="50" height="50" layout="fixed" alt="h4rithd.com"></amp-img>
        <h3>h4rithd.com</h3>
            <p>Penetration Tester | Ethical Hacker | Security Researcher</p>
        <p><a href="../../index.html">Read more posts ‚Üí</a></p>
        <a class="powered" href="https://ghost.org" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156 156"><g fill="none" fill-rule="evenodd"><rect fill="#15212B" width="156" height="156" rx="27"/><g transform="translate(36 36)" fill="#F6F8FA"><path d="M0 71.007A4.004 4.004 0 014 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0130 84H4a4 4 0 01-4-4.007v-8.986zM50 71.007A4.004 4.004 0 0154 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0180 84H54a4 4 0 01-4-4.007v-8.986z"/><rect y="34" width="84" height="17" rx="4"/><path d="M0 4.007A4.007 4.007 0 014.007 0h41.986A4.003 4.003 0 0150 4.007v8.986A4.007 4.007 0 0145.993 17H4.007A4.003 4.003 0 010 12.993V4.007z"/><rect x="67" width="17" height="17" rx="4"/></g></g></svg> Published with Ghost</a>
    </footer>
    
</body>
</html>
